{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "copyrighted-buffalo",
   "metadata": {},
   "source": [
    "## Single-Cell Analysis (3):\n",
    "- Cell type: Induced Pluripotent stem cell (iPSC)\n",
    "- Title: \"iPSCs Reveal Protective Modifiers of the BMPR2 mutation in Pulmonary Arterial Hypertension\"\n",
    "- Data: ..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "brazilian-optimization",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: scprep in /root/.local/lib/python3.8/site-packages (1.1.0)\n",
      "Requirement already satisfied: packaging in /opt/python/lib/python3.8/site-packages (from scprep) (20.8)\n",
      "Requirement already satisfied: scikit-learn>=0.19.1 in /opt/python/lib/python3.8/site-packages (from scprep) (0.24.0)\n",
      "Requirement already satisfied: scipy>=0.18.1 in /opt/python/lib/python3.8/site-packages (from scprep) (1.6.0)\n",
      "Requirement already satisfied: pandas>=0.25 in /opt/python/lib/python3.8/site-packages (from scprep) (1.2.0)\n",
      "Requirement already satisfied: decorator>=4.3.0 in /opt/python/lib/python3.8/site-packages (from scprep) (4.4.2)\n",
      "Requirement already satisfied: numpy>=1.12.0 in /opt/python/lib/python3.8/site-packages (from scprep) (1.19.5)\n",
      "Requirement already satisfied: python-dateutil>=2.7.3 in /opt/python/lib/python3.8/site-packages (from pandas>=0.25->scprep) (2.8.1)\n",
      "Requirement already satisfied: pytz>=2017.3 in /opt/python/lib/python3.8/site-packages (from pandas>=0.25->scprep) (2020.5)\n",
      "Requirement already satisfied: six>=1.5 in /opt/python/lib/python3.8/site-packages (from python-dateutil>=2.7.3->pandas>=0.25->scprep) (1.15.0)\n",
      "Requirement already satisfied: threadpoolctl>=2.0.0 in /opt/python/lib/python3.8/site-packages (from scikit-learn>=0.19.1->scprep) (2.1.0)\n",
      "Requirement already satisfied: joblib>=0.11 in /opt/python/lib/python3.8/site-packages (from scikit-learn>=0.19.1->scprep) (1.0.0)\n",
      "Requirement already satisfied: pyparsing>=2.0.2 in /opt/python/lib/python3.8/site-packages (from packaging->scprep) (2.4.7)\n",
      "\u001b[33mWARNING: You are using pip version 20.3.3; however, version 21.0.1 is available.\n",
      "You should consider upgrading via the '/opt/python/bin/python3.8 -m pip install --upgrade pip' command.\u001b[0m\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install --user scprep"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "stainless-determination",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: matplotlib in /opt/python/lib/python3.8/site-packages (3.3.3)\n",
      "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3 in /opt/python/lib/python3.8/site-packages (from matplotlib) (2.4.7)\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /opt/python/lib/python3.8/site-packages (from matplotlib) (1.3.1)\n",
      "Requirement already satisfied: numpy>=1.15 in /opt/python/lib/python3.8/site-packages (from matplotlib) (1.19.5)\n",
      "Requirement already satisfied: cycler>=0.10 in /opt/python/lib/python3.8/site-packages (from matplotlib) (0.10.0)\n",
      "Requirement already satisfied: python-dateutil>=2.1 in /opt/python/lib/python3.8/site-packages (from matplotlib) (2.8.1)\n",
      "Requirement already satisfied: pillow>=6.2.0 in /opt/python/lib/python3.8/site-packages (from matplotlib) (8.1.0)\n",
      "Requirement already satisfied: six in /opt/python/lib/python3.8/site-packages (from cycler>=0.10->matplotlib) (1.15.0)\n",
      "\u001b[33mWARNING: You are using pip version 20.3.3; however, version 21.0.1 is available.\n",
      "You should consider upgrading via the '/opt/python/bin/python3.8 -m pip install --upgrade pip' command.\u001b[0m\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install matplotlib"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "sunrise-uruguay",
   "metadata": {},
   "outputs": [],
   "source": [
    "import scprep\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "lesbian-contribution",
   "metadata": {},
   "source": [
    "## iPSC Data analysis:\n",
    "- https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE79613 \n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "controlling-denver",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>5S_rRNA</th>\n",
       "      <th>7SK</th>\n",
       "      <th>A1BG</th>\n",
       "      <th>A1BG-AS1</th>\n",
       "      <th>A1CF</th>\n",
       "      <th>A2M</th>\n",
       "      <th>A2M-AS1</th>\n",
       "      <th>A2ML1</th>\n",
       "      <th>A2MP1</th>\n",
       "      <th>A3GALT2</th>\n",
       "      <th>A4GALT</th>\n",
       "      <th>AAAS</th>\n",
       "      <th>AACS</th>\n",
       "      <th>AADAC</th>\n",
       "      <th>AADACL2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P1</th>\n",
       "      <td>3.0</td>\n",
       "      <td>115.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3666.0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>206.0</td>\n",
       "      <td>997.0</td>\n",
       "      <td>759.0</td>\n",
       "      <td>129.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_HPAH</th>\n",
       "      <td>1.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>625.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>86.0</td>\n",
       "      <td>559.0</td>\n",
       "      <td>729.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_Carrier</th>\n",
       "      <td>2.0</td>\n",
       "      <td>82.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>330.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>146.0</td>\n",
       "      <td>685.0</td>\n",
       "      <td>922.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_Carrier</th>\n",
       "      <td>5.0</td>\n",
       "      <td>125.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>244.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>424.0</td>\n",
       "      <td>1219.0</td>\n",
       "      <td>367.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_Carrier</th>\n",
       "      <td>6.0</td>\n",
       "      <td>119.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7460.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>143.0</td>\n",
       "      <td>767.0</td>\n",
       "      <td>915.0</td>\n",
       "      <td>60.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P3</th>\n",
       "      <td>1.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2801.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>134.0</td>\n",
       "      <td>661.0</td>\n",
       "      <td>1126.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P2</th>\n",
       "      <td>1.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>103.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>126.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>153.0</td>\n",
       "      <td>1346.0</td>\n",
       "      <td>1378.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_Ctrl</th>\n",
       "      <td>5.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>247.0</td>\n",
       "      <td>819.0</td>\n",
       "      <td>532.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_Ctrl</th>\n",
       "      <td>1.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>19151.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>401.0</td>\n",
       "      <td>706.0</td>\n",
       "      <td>810.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_HPAH</th>\n",
       "      <td>1.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>12405.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>208.0</td>\n",
       "      <td>670.0</td>\n",
       "      <td>760.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_Ctrl</th>\n",
       "      <td>1.0</td>\n",
       "      <td>102.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>20517.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>211.0</td>\n",
       "      <td>790.0</td>\n",
       "      <td>776.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              5S_rRNA    7SK  A1BG  A1BG-AS1  A1CF      A2M  A2M-AS1  A2ML1  \\\n",
       "Fam1_HPAH_P1      3.0  115.0   3.0      59.0   0.0   3666.0     37.0    1.0   \n",
       "Fam3_HPAH         1.0   73.0   3.0      55.0   0.0    625.0      1.0    0.0   \n",
       "Fam3_Carrier      2.0   82.0   5.0      30.0   0.0    330.0      8.0    1.0   \n",
       "Fam1_Carrier      5.0  125.0   1.0      24.0   0.0    244.0     12.0    2.0   \n",
       "Fam2_Carrier      6.0  119.0   0.0      55.0   0.0   7460.0     11.0    0.0   \n",
       "Fam1_HPAH_P3      1.0   71.0  11.0      65.0   0.0   2801.0      1.0    1.0   \n",
       "Fam1_HPAH_P2      1.0  100.0   7.0     103.0   0.0    126.0     16.0    2.0   \n",
       "Fam1_Ctrl         5.0   74.0   6.0      58.0   0.0     13.0      1.0    0.0   \n",
       "Fam2_Ctrl         1.0  150.0   4.0      70.0   0.0  19151.0      6.0    1.0   \n",
       "Fam2_HPAH         1.0  145.0   5.0      15.0   0.0  12405.0      6.0    0.0   \n",
       "Fam3_Ctrl         1.0  102.0   5.0      73.0   1.0  20517.0      4.0    0.0   \n",
       "\n",
       "              A2MP1  A3GALT2  A4GALT    AAAS    AACS  AADAC  AADACL2  \n",
       "Fam1_HPAH_P1   17.0      0.0   206.0   997.0   759.0  129.0      1.0  \n",
       "Fam3_HPAH       1.0      0.0    86.0   559.0   729.0    6.0      1.0  \n",
       "Fam3_Carrier    1.0      0.0   146.0   685.0   922.0   20.0      0.0  \n",
       "Fam1_Carrier    0.0      0.0   424.0  1219.0   367.0    0.0      0.0  \n",
       "Fam2_Carrier    0.0      1.0   143.0   767.0   915.0   60.0      1.0  \n",
       "Fam1_HPAH_P3    0.0      0.0   134.0   661.0  1126.0   48.0      0.0  \n",
       "Fam1_HPAH_P2    0.0      0.0   153.0  1346.0  1378.0   20.0      0.0  \n",
       "Fam1_Ctrl       0.0      1.0   247.0   819.0   532.0    2.0      0.0  \n",
       "Fam2_Ctrl       2.0      0.0   401.0   706.0   810.0    5.0      0.0  \n",
       "Fam2_HPAH       0.0      0.0   208.0   670.0   760.0   21.0      0.0  \n",
       "Fam3_Ctrl       0.0      0.0   211.0   790.0   776.0    8.0      0.0  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "iPSC_file_read = scprep.io.load_csv('Desktop/GSE79613_RNA-seq_raw_read_counts.csv', delimiter = '\\t', gene_names=True, sparse=True)\n",
    "#iPSC_file_read = scprep.io.load_csv('Desktop/Projects/School/iPSC/GSE154580_rpm.bcmatrix copy.csv', delimiter='\\t', gene_names=True, sparse=True)\n",
    "iPSC_file_read.head(15).T"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "daily-milwaukee",
   "metadata": {},
   "source": [
    "### Preprocessing/ Loading/ Filtering\n",
    "#### Normalization: \n",
    "- align the scales of gene expression across cells that have different # of UMIs / cell.\n",
    "- The sum of expression values for each cell sums to 1 then returns normalized matrix to the metric space using median UMI count per cell effectively scaling all cells as if they were sampled evenly."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "dominant-fortune",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/root/.local/lib/python3.8/site-packages/scprep/select.py:369: UserWarning: No selection conditions provided. Returning all columns.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>5S_rRNA</th>\n",
       "      <th>7SK</th>\n",
       "      <th>A1BG</th>\n",
       "      <th>A1BG-AS1</th>\n",
       "      <th>A1CF</th>\n",
       "      <th>A2M</th>\n",
       "      <th>A2M-AS1</th>\n",
       "      <th>A2ML1</th>\n",
       "      <th>A2MP1</th>\n",
       "      <th>A3GALT2</th>\n",
       "      <th>...</th>\n",
       "      <th>hsa-mir-8072</th>\n",
       "      <th>snR65</th>\n",
       "      <th>snoR442</th>\n",
       "      <th>snoU109</th>\n",
       "      <th>snoU13</th>\n",
       "      <th>snoU2-30</th>\n",
       "      <th>snoU2_19</th>\n",
       "      <th>snoZ13_snr52</th>\n",
       "      <th>snoZ185</th>\n",
       "      <th>snoZ5</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P1</th>\n",
       "      <td>3.0</td>\n",
       "      <td>115.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3666.0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>19.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>133.0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_HPAH</th>\n",
       "      <td>1.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>625.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_Carrier</th>\n",
       "      <td>2.0</td>\n",
       "      <td>82.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>330.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_Carrier</th>\n",
       "      <td>5.0</td>\n",
       "      <td>125.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>244.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>28.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>174.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_Carrier</th>\n",
       "      <td>6.0</td>\n",
       "      <td>119.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7460.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>97.0</td>\n",
       "      <td>63.0</td>\n",
       "      <td>104.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P3</th>\n",
       "      <td>1.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2801.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>18.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>104.0</td>\n",
       "      <td>28.0</td>\n",
       "      <td>49.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P2</th>\n",
       "      <td>1.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>103.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>126.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>141.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>118.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_Ctrl</th>\n",
       "      <td>5.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>123.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_Ctrl</th>\n",
       "      <td>1.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>19151.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>40.0</td>\n",
       "      <td>113.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_HPAH</th>\n",
       "      <td>1.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>12405.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_Ctrl</th>\n",
       "      <td>1.0</td>\n",
       "      <td>102.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>20517.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>102.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11 rows × 34706 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              5S_rRNA    7SK  A1BG  A1BG-AS1  A1CF      A2M  A2M-AS1  A2ML1  \\\n",
       "Fam1_HPAH_P1      3.0  115.0   3.0      59.0   0.0   3666.0     37.0    1.0   \n",
       "Fam3_HPAH         1.0   73.0   3.0      55.0   0.0    625.0      1.0    0.0   \n",
       "Fam3_Carrier      2.0   82.0   5.0      30.0   0.0    330.0      8.0    1.0   \n",
       "Fam1_Carrier      5.0  125.0   1.0      24.0   0.0    244.0     12.0    2.0   \n",
       "Fam2_Carrier      6.0  119.0   0.0      55.0   0.0   7460.0     11.0    0.0   \n",
       "Fam1_HPAH_P3      1.0   71.0  11.0      65.0   0.0   2801.0      1.0    1.0   \n",
       "Fam1_HPAH_P2      1.0  100.0   7.0     103.0   0.0    126.0     16.0    2.0   \n",
       "Fam1_Ctrl         5.0   74.0   6.0      58.0   0.0     13.0      1.0    0.0   \n",
       "Fam2_Ctrl         1.0  150.0   4.0      70.0   0.0  19151.0      6.0    1.0   \n",
       "Fam2_HPAH         1.0  145.0   5.0      15.0   0.0  12405.0      6.0    0.0   \n",
       "Fam3_Ctrl         1.0  102.0   5.0      73.0   1.0  20517.0      4.0    0.0   \n",
       "\n",
       "              A2MP1  A3GALT2  ...  hsa-mir-8072  snR65  snoR442  snoU109  \\\n",
       "Fam1_HPAH_P1   17.0      0.0  ...          19.0    1.0      0.0     15.0   \n",
       "Fam3_HPAH       1.0      0.0  ...           7.0    0.0      0.0      8.0   \n",
       "Fam3_Carrier    1.0      0.0  ...           5.0    0.0      0.0     20.0   \n",
       "Fam1_Carrier    0.0      0.0  ...          28.0    0.0      1.0      5.0   \n",
       "Fam2_Carrier    0.0      1.0  ...           6.0    0.0      1.0      7.0   \n",
       "Fam1_HPAH_P3    0.0      0.0  ...          18.0    0.0      1.0     15.0   \n",
       "Fam1_HPAH_P2    0.0      0.0  ...           7.0    0.0      1.0     15.0   \n",
       "Fam1_Ctrl       0.0      1.0  ...           7.0    0.0      1.0     10.0   \n",
       "Fam2_Ctrl       2.0      0.0  ...           6.0    0.0      0.0     40.0   \n",
       "Fam2_HPAH       0.0      0.0  ...           3.0    1.0      1.0      5.0   \n",
       "Fam3_Ctrl       0.0      0.0  ...           8.0    0.0      0.0     27.0   \n",
       "\n",
       "              snoU13  snoU2-30  snoU2_19  snoZ13_snr52  snoZ185  snoZ5  \n",
       "Fam1_HPAH_P1   133.0      37.0      52.0           0.0      0.0    0.0  \n",
       "Fam3_HPAH       57.0      19.0      25.0           1.0      0.0    0.0  \n",
       "Fam3_Carrier    71.0      27.0      35.0           0.0      0.0    4.0  \n",
       "Fam1_Carrier   174.0      53.0      70.0           0.0      0.0    2.0  \n",
       "Fam2_Carrier    97.0      63.0     104.0           0.0      0.0    0.0  \n",
       "Fam1_HPAH_P3   104.0      28.0      49.0           0.0      2.0    0.0  \n",
       "Fam1_HPAH_P2   141.0      71.0     118.0           0.0      0.0    0.0  \n",
       "Fam1_Ctrl      123.0      19.0      24.0           0.0      0.0    0.0  \n",
       "Fam2_Ctrl      113.0      25.0      31.0           0.0      0.0    2.0  \n",
       "Fam2_HPAH       62.0      19.0      32.0           0.0      0.0    1.0  \n",
       "Fam3_Ctrl      102.0      24.0      48.0           0.0      0.0    5.0  \n",
       "\n",
       "[11 rows x 34706 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#iPSC_data = scprep.filter.filter_library_size(iPSC_file_read, cutoff=0.01, keep_cells='above')\n",
    "iPSC_data = scprep.filter.filter_gene_set_expression(iPSC_file_read, cutoff=0.01, library_size_normalize=True, keep_cells='above').T\n",
    "iPSC_data\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "electronic-tamil",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/root/.local/lib/python3.8/site-packages/scprep/select.py:369: UserWarning: No selection conditions provided. Returning all columns.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Fam1_HPAH_P1</th>\n",
       "      <th>Fam3_HPAH</th>\n",
       "      <th>Fam3_Carrier</th>\n",
       "      <th>Fam1_Carrier</th>\n",
       "      <th>Fam2_Carrier</th>\n",
       "      <th>Fam1_HPAH_P3</th>\n",
       "      <th>Fam1_HPAH_P2</th>\n",
       "      <th>Fam1_Ctrl</th>\n",
       "      <th>Fam2_Ctrl</th>\n",
       "      <th>Fam2_HPAH</th>\n",
       "      <th>Fam3_Ctrl</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5S_rRNA</th>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7SK</th>\n",
       "      <td>115.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>82.0</td>\n",
       "      <td>125.0</td>\n",
       "      <td>119.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>102.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A1BG</th>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A1BG-AS1</th>\n",
       "      <td>59.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>103.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>73.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A1CF</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>snoU2-30</th>\n",
       "      <td>37.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>63.0</td>\n",
       "      <td>28.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>24.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>snoU2_19</th>\n",
       "      <td>52.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>104.0</td>\n",
       "      <td>49.0</td>\n",
       "      <td>118.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>48.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>snoZ13_snr52</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>snoZ185</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>snoZ5</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>34706 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              Fam1_HPAH_P1  Fam3_HPAH  Fam3_Carrier  Fam1_Carrier  \\\n",
       "id                                                                  \n",
       "5S_rRNA                3.0        1.0           2.0           5.0   \n",
       "7SK                  115.0       73.0          82.0         125.0   \n",
       "A1BG                   3.0        3.0           5.0           1.0   \n",
       "A1BG-AS1              59.0       55.0          30.0          24.0   \n",
       "A1CF                   0.0        0.0           0.0           0.0   \n",
       "...                    ...        ...           ...           ...   \n",
       "snoU2-30              37.0       19.0          27.0          53.0   \n",
       "snoU2_19              52.0       25.0          35.0          70.0   \n",
       "snoZ13_snr52           0.0        1.0           0.0           0.0   \n",
       "snoZ185                0.0        0.0           0.0           0.0   \n",
       "snoZ5                  0.0        0.0           4.0           2.0   \n",
       "\n",
       "              Fam2_Carrier  Fam1_HPAH_P3  Fam1_HPAH_P2  Fam1_Ctrl  Fam2_Ctrl  \\\n",
       "id                                                                             \n",
       "5S_rRNA                6.0           1.0           1.0        5.0        1.0   \n",
       "7SK                  119.0          71.0         100.0       74.0      150.0   \n",
       "A1BG                   0.0          11.0           7.0        6.0        4.0   \n",
       "A1BG-AS1              55.0          65.0         103.0       58.0       70.0   \n",
       "A1CF                   0.0           0.0           0.0        0.0        0.0   \n",
       "...                    ...           ...           ...        ...        ...   \n",
       "snoU2-30              63.0          28.0          71.0       19.0       25.0   \n",
       "snoU2_19             104.0          49.0         118.0       24.0       31.0   \n",
       "snoZ13_snr52           0.0           0.0           0.0        0.0        0.0   \n",
       "snoZ185                0.0           2.0           0.0        0.0        0.0   \n",
       "snoZ5                  0.0           0.0           0.0        0.0        2.0   \n",
       "\n",
       "              Fam2_HPAH  Fam3_Ctrl  \n",
       "id                                  \n",
       "5S_rRNA             1.0        1.0  \n",
       "7SK               145.0      102.0  \n",
       "A1BG                5.0        5.0  \n",
       "A1BG-AS1           15.0       73.0  \n",
       "A1CF                0.0        1.0  \n",
       "...                 ...        ...  \n",
       "snoU2-30           19.0       24.0  \n",
       "snoU2_19           32.0       48.0  \n",
       "snoZ13_snr52        0.0        0.0  \n",
       "snoZ185             0.0        0.0  \n",
       "snoZ5               1.0        5.0  \n",
       "\n",
       "[34706 rows x 11 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "iPSC_data_T = scprep.filter.filter_gene_set_expression(iPSC_file_read, cutoff=0.01, library_size_normalize=True, keep_cells='above')\n",
    "iPSC_data_T"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "ready-bridal",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "genes_per_cell = np.sum(iPSC_data > 0, axis=0)\n",
    "\n",
    "fig, ax = plt.subplots(1, figsize=(8,8))\n",
    "ax.hist(genes_per_cell, bins=50)\n",
    "ax.set_xlabel('Count Depth')\n",
    "ax.set_ylabel('Frequency')\n",
    "ax.set_yscale('symlog')\n",
    "ax.set_title('Gene detection across cells')\n",
    "fig.tight_layout()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "abroad-stage",
   "metadata": {},
   "source": [
    "#### Removing cells with high mitochondrial gene expression (Quality Control)\n",
    "# Error: try again after rescaling"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "challenging-distance",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0.5, 1.0, 'Mitochondrial expression')"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYgAAAGDCAYAAAAxhIflAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/Il7ecAAAACXBIWXMAAAsTAAALEwEAmpwYAAAkCUlEQVR4nO3deZgldX3v8fdHQEBFBWZiZB00uJCoqHPRRFS8UQSiYm4WwSWg5hJzXaLR5OISREzySJLrFhdEMxI30KgkY4QgiQsuQRmUXZFxxDBAZHPDBQW/94/6tRTNr3t6oE93D/N+Pc95uupXy/lWTc35nKo653dSVUiSNN2dFrsASdLSZEBIkroMCElSlwEhSeoyICRJXQaEJKnLgNCCSHJckr+YwHo/neQP53u9MzxXJfmVWabPeRsXsu6FlOTUJIctdh2aH1sudgHatCW5FNgJ2Kmqrhm1fwXYG9ijqi6tqueNpu0HvK+qdlnQYidsvI2bq6o6cLFr0PzxDELz4ZvAoVMjSR4E3GXxyll4SbZY7Bo21qZYsxaWAaH58F7gD0bjhwHvGc+Q5IQkf5nkrsCpwE5Jrm+PnZJsneSNSa5ojzcm2Xq0/MFJzkny/STfSHLAaPW7J/l8kh8k+USSZaPlnpLkwiTfbZd1HjiadmmSlyU5L8n3knwwyTaj6X+W5MpWz3M62/P2JKck+SHwuKltbNO3T/KvSa5O8p02PKczpiR3SnJk285rk3woyQ5t2tuTfGQ077FJ/iOD/ZKsT/KKJNe07XvGBmreKclHWp3fTPKi0fz7JFnT9vm3k7y+tW+T5H2ttu8mOSvJvdq0X1w6a9vxqiTfSnJVkvckuUebtqJdsjssyX+1el85l/2jhWNAaD6cCdw9yQPbu9JDgPf1ZqyqHwIHAldU1d3a4wrglcAjGS5LPQTYB3gVDC9UDIHzZ8A9gccAl45W+3Tg2cAvAXcGXtaWux9wIvBiYDlwCvCxJHceLfv7wAHAHsCDgcPbsge09TwB2BN4fGdzng78FbAd8Llp0+4EvBvYHdgN+DHwlt4+6Xgh8FTgsQyX774DvLVNeynwoCSHJ3k08FzgsLq5z5xfBpYBOzME9fFJ7j9DzV8APgac2+b/TeDFSZ7Y5n0T8KaqujtwX+BDrf0w4B7ArsCOwPPa9k13eHs8DrgPcLfOPtgXuH977qPGAa7FZ0BovkydRTwB+Cpw+UYu/wzgmKq6qqquBl4DPKtNey6wqqpOr6qfV9XlVfW10bLvrqqvV9WPGV7E9m7tTwM+3pb7GfB3wLbAb4yWfXNVXVFV1zG8WE4t+/ttvRe0UDu6U/O/VNXnW00/GU+oqmur6iNV9aOq+gHDi/Jj57gvnge8sqrWV9UN7bl/N8mWVfWjtl9ezxDCL6yq9dOW/4uquqGqPgN8vG3LrWoGHgQsr6pjquqnVbUOeCdDwAP8DPiVJMuq6vqqOnPUviPwK1V1U1WdXVXf72zHM4DXV9W6qroeeDlwSJLxvc/XVNWPq+pchqB6yBz3kRaAAaH58l6Gd6eHM+3y0hztBHxrNP6t1gbDO9VvzLLsf4+Gf8TwTvVW62wvipcxvFuey7KXTatnuss6bQAkuUuSd7TLK98HzgDumbld998dOLldvvkuQ+DeBNyrbccXgXVAuPld/ZTvtEAb173TaHxc8+4Ml/q+O3quV0w9D0Mw3w/4WruM9KTW/l7gNOCkdvntb5Js1dmO3r/plqP1w8z7X0uAAaF5UVXfYrhZfRDw0Q3N3mm7guEFa8purQ2GF7X73oaybrHOJGEIm7mc3VzZ5h3XM91sXSG/lOHSySPaJZrHTJUxh+e+DDiwqu45emxTVZcDJHk+sDXD9v35tGW3z3CfZ1z3FaPxcc2XAd+c9jzbVdVBAFV1SVUdynDp7ljgw0nuWlU/q6rXVNVeDGdjT+KW96Cm9P5NbwS+PYd9oCXAgNB8ei7wP6e9g+35NrDj1A3L5kTgVUmWt5vMR3HzfYx/AJ6d5Dfbjc+dkzxgDvV8CPitttxWDC/aNzBce5/Lsocn2SvJXYBXz2GZse0Yrst/t91g3pjljwP+KsnuAG2fHNyG7wf8JfBMhktNf55k72nLvybJnds9iicB/zTD83wJ+EGS/5tk2yRbJPm1JP+jPdczkyxvZ17fbcv8PMnjkjyonQ19n+GS08876z8ReEmSPZLcDfhr4INVdeNG7AstIgNC86aqvlFVa+Yw39cYXjzWtUsbOzG86K0BzgPOB77c2qiqLzHchH4D8D3gM9zynelMz3Mxwwvp3wPXAE8GnlxVP53DsqcCbwQ+CaxtfzfGGxnud1zDcBP/3zZi2TcBq4FPJPlBW/4R7dr9+4Bjq+rcqrqE4ZLQe3PzJ77+m+Gm9hXA+4HnTbtf8wtVdRNDgOzNcPZ3DfAuhhvQMNy8vzDJ9a2mQ9p9nl8GPswQDl9l+Pd4b+cpVrX2M9r6f8JwA16biPiDQdIdQ+6gX0DU4vEMQpLUZUBIkrq8xCRJ6vIMQpLUZUBIkrruUN19L1u2rFasWLHYZUi6o7v44uHv/e8/+3ybgLPPPvuaqlrem3aHCogVK1awZs0GP4YvSbfPfvsNfz/96cWsYl4k6XUjA3iJSZI0AwNCktRlQEiSugwISVKXASFJ6jIgJEldBoQkqcuAkCR1GRCSpC4DQpLUNbGASLJrkk8luSjJhUn+pDNPkrw5ydok5yV52GjaYUkuaY/DJlWnJKlvkn0x3Qi8tKq+nGQ74Owkp1fVRaN5DgT2bI9HAG9n+O3dqR95XwlUW3Z1VX1ngvVKkkYmdgZRVVdW1Zfb8A8Yftx852mzHQy8pwZnAvdMcm/gicDpVXVdC4XTGX5AXZK0QBakN9ckK4CHAl+cNmln4LLR+PrWNlN7b91HAEcA7LbbbvNTsDY7K478+IzTLn3dby1gJdLSMfGb1EnuBnwEeHFVfX++119Vx1fVyqpauXx5t0tzSdJtMNGASLIVQzi8v6o+2pnlcmDX0fgurW2mdknSApnkp5gC/APw1ap6/QyzrQb+oH2a6ZHA96rqSuA0YP8k2yfZHti/tUmSFsgk70E8CngWcH6Sc1rbK4DdAKrqOOAU4CBgLfAj4Nlt2nVJXguc1ZY7pqqum2CtkqRpJhYQVfU5IBuYp4DnzzBtFbBqAqVJkubAb1JLkroMCElSlwEhSeoyICRJXQaEJKnLgJAkdRkQkqQuA0KS1GVASJK6DAhJUpcBIUnqMiAkSV0GhCSpy4CQJHUZEJKkLgNCktRlQEiSugwISVKXASFJ6jIgJEldBoQkqcuAkCR1GRCSpC4DQpLUZUBIkroMCElSlwEhSeoyICRJXQaEJKnLgJAkdW05qRUnWQU8Cbiqqn6tM/3PgGeM6nggsLyqrktyKfAD4CbgxqpaOak6JUl9kzyDOAE4YKaJVfW3VbV3Ve0NvBz4TFVdN5rlcW264SBJi2BiAVFVZwDXbXDGwaHAiZOqRZK08Rb9HkSSuzCcaXxk1FzAJ5KcneSIDSx/RJI1SdZcffXVkyxVkjYrix4QwJOBz0+7vLRvVT0MOBB4fpLHzLRwVR1fVSurauXy5csnXaskbTaWQkAcwrTLS1V1eft7FXAysM8i1CVJm7VFDYgk9wAeC/zLqO2uSbabGgb2By5YnAolafM1yY+5ngjsByxLsh54NbAVQFUd12b7beATVfXD0aL3Ak5OMlXfB6rq3yZVpySpb2IBUVWHzmGeExg+DjtuWwc8ZDJVSZLmaincg5AkLUEGhCSpy4CQJHUZEJKkLgNCktRlQEiSugwISVKXASFJ6jIgJEldBoQkqcuAkCR1GRCSpC4DQpLUZUBIkroMCElSlwEhSeoyICRJXQaEJKnLgJAkdRkQkqQuA0KS1GVASJK6DAhJUpcBIUnqMiAkSV0GhCSpy4CQJHUZEJKkLgNCktQ1sYBIsirJVUkumGH6fkm+l+Sc9jhqNO2AJBcnWZvkyEnVKEma2STPIE4ADtjAPJ+tqr3b4xiAJFsAbwUOBPYCDk2y1wTrlCR1TCwgquoM4LrbsOg+wNqqWldVPwVOAg6e1+IkSRu02Pcgfj3JuUlOTfKrrW1n4LLRPOtbmyRpAW25iM/9ZWD3qro+yUHAPwN7buxKkhwBHAGw2267zWuBkrQ5W7QziKr6flVd34ZPAbZKsgy4HNh1NOsurW2m9RxfVSurauXy5csnWrMkbU4WLSCS/HKStOF9Wi3XAmcBeybZI8mdgUOA1YtVpyRtriZ2iSnJicB+wLIk64FXA1sBVNVxwO8Cf5zkRuDHwCFVVcCNSV4AnAZsAayqqgsnVackqW9iAVFVh25g+luAt8ww7RTglEnUJUmam8X+FJMkaYkyICRJXQaEJKnLgJAkdRkQkqQuA0KS1GVASJK6DAhJUpcBIUnqMiAkSV0GhCSpy4CQJHUZEJKkLgNCktRlQEiSugwISVKXASFJ6jIgJEldBoQkqcuAkCR1GRCSpC4DQpLUZUBIkroMCElSlwEhSeoyICRJXQaEJKnLgJAkdRkQkqQuA0KS1DWxgEiyKslVSS6YYfozkpyX5PwkX0jykNG0S1v7OUnWTKpGSdLMJnkGcQJwwCzTvwk8tqoeBLwWOH7a9MdV1d5VtXJC9UmSZrHlpFZcVWckWTHL9C+MRs8EdplULZKkjbdU7kE8Fzh1NF7AJ5KcneSIRapJkjZrEzuDmKskj2MIiH1HzftW1eVJfgk4PcnXquqMGZY/AjgCYLfddpt4vZK0uVjUM4gkDwbeBRxcVddOtVfV5e3vVcDJwD4zraOqjq+qlVW1cvny5ZMuWZI2G4sWEEl2Az4KPKuqvj5qv2uS7aaGgf2B7iehJEmTM7FLTElOBPYDliVZD7wa2Aqgqo4DjgJ2BN6WBODG9omlewEnt7YtgQ9U1b9Nqk5JUt8kP8V06Aam/yHwh532dcBDbr2EJGkhLZVPMUmSlhgDQpLUZUBIkroMCElS1wYDon3s9E5t+H5JnpJkq8mXJklaTHM5gzgD2CbJzsAngGcxdMQnSboDm0tApKp+BPwv4G1V9XvAr062LEnSYptTQCT5deAZwMdb2xaTK0mStBTMJSBeDLwcOLmqLkxyH+BTE61KkrToNvhN6qr6DPCZ0fg64EWTLEqStPhmDIgkH2P4XYauqnrKRCqSJC0Js51B/N2CVSFJWnJmDIh2aUmStJma7RLT+fQvMQWoqnrwxKqSJC262S4xPWnBqpAkLTmzXWL61tRwkt2BPavq35NsO9tykqQ7hrn0xfS/gQ8D72hNuwD/PMGaJElLwFy+KPd84FHA9wGq6hLglyZZlCRp8c0lIG6oqp9OjSTZklm+HyFJumOYS0B8JskrgG2TPAH4J+Bjky1LkrTY5hIQRwJXA+cDfwScArxqkkVJkhbfXD6NtC2wqqreCZBki9b2o0kWJklaXHM5g/gPhkCYsi3w75MpR5K0VMwlILapquunRtrwXSZXkiRpKZhLQPwwycOmRpI8HPjx5EqSJC0Fc7kH8WLgn5JcwdAP0y8DT5tkUZKkxTeXHww6K8kDgPu3pour6meTLUuStNjm1KdSC4QLJlyLJGkJmcs9CEnSZmjGgEjyqPZ364UrR5K0VMx2BvHm9vc/b+vKk6xKclWS7uWpDN6cZG2S86Z9WuqwJJe0x2G3tQZJ0m0z2z2InyU5Htg5yZunT6yqF81h/ScAbwHeM8P0A4E92+MRwNuBRyTZAXg1sJKhY8Czk6yuqu/M4TklSfNgQ78o93jgicDZt2XlVXVGkhWzzHIw8J6qKuDMJPdMcm9gP+D0qroOIMnpwAHAibelDknSxpvtF+WuAU5K8tWqOndCz78zcNlofH1rm6n9VpIcARwBsNtuu93mQlYc+fEZp136ut+6zeu9o9kc99OmvM2z1T6bpb5ds7mt/14bs69OWnctAI+ce1m322Ich3P5FNO1SU5u9xKuSvKRJLtMpJrboKqOr6qVVbVy+fLli12OJN1hzCUg3g2sBnZqj4+1tvlwObDraHyX1jZTuyRpgcwlIH6pqt5dVTe2xwnAfL1VXw38Qfs00yOB71XVlcBpwP5Jtk+yPbB/a5MkLZC5fJP6miTP5OYbxIcC185l5UlOZLjhvCzJeoZPJm0FUFXHMfz40EHAWobfl3h2m3ZdktcCZ7VVHTN1w1qStDDmEhDPAf4eeAPDR06/QHsh35CqOnQD0wt4/gzTVgGr5vI8kqT5N5fO+r4FPGUBapEkLSH2xSRJ6jIgJEldBoQkqWuDAZHkVaNhe3aVpM3EbN19/98kvw787qj5NvfsKknatMz2KaavAb8H3CfJZ9v4jknuX1UXL0h1kqRFM9slpu8Cr2D4Ett+wJta+5FJvjDZsiRJi222M4gnAkcB9wVeD5wH/LCq5vQlOUnSpm3GM4iqekVV/SZwKfBeYAtgeZLPJfnYAtUnSVokc+lq47SqWgOsSfLHVbVvkmWTLkyStLg2+DHXqvrz0ejhre2aSRUkSVoaNuqLchP8ZTlJ0hLjN6klSV0GhCSpy4CQJHUZEJKkLgNCktRlQEiSugwISVKXASFJ6jIgJEldBoQkqcuAkCR1GRCSpC4DQpLUZUBIkroMCElSlwEhSeoyICRJXRMNiCQHJLk4ydokR3amvyHJOe3x9STfHU27aTRt9STrlCTd2paTWnGSLYC3Ak8A1gNnJVldVRdNzVNVLxnN/0LgoaNV/Liq9p5UfZKk2U3yDGIfYG1VrauqnwInAQfPMv+hwIkTrEeStBEmGRA7A5eNxte3tltJsjuwB/DJUfM2SdYkOTPJU2d6kiRHtPnWXH311fNQtiQJls5N6kOAD1fVTaO23atqJfB04I1J7ttbsKqOr6qVVbVy+fLlC1GrJG0WJhkQlwO7jsZ3aW09hzDt8lJVXd7+rgM+zS3vT0iSJmySAXEWsGeSPZLcmSEEbvVppCQPALYH/nPUtn2SrdvwMuBRwEXTl5UkTc7EPsVUVTcmeQFwGrAFsKqqLkxyDLCmqqbC4hDgpKqq0eIPBN6R5OcMIfa68aefJEmTN7GAAKiqU4BTprUdNW386M5yXwAeNMnaJEmzWyo3qSVJS4wBIUnqMiAkSV0GhCSpy4CQJHUZEJKkLgNCktRlQEiSugwISVKXASFJ6jIgJEldBoQkqcuAkCR1GRCSpC4DQpLUZUBIkroMCElSlwEhSeoyICRJXQaEJKnLgJAkdRkQkqQuA0KS1GVASJK6DAhJUpcBIUnqMiAkSV0GhCSpy4CQJHUZEJKkrokGRJIDklycZG2SIzvTD09ydZJz2uMPR9MOS3JJexw2yTolSbe25aRWnGQL4K3AE4D1wFlJVlfVRdNm/WBVvWDasjsArwZWAgWc3Zb9zqTqlSTd0iTPIPYB1lbVuqr6KXAScPAcl30icHpVXddC4XTggAnVKUnqmGRA7AxcNhpf39qm+50k5yX5cJJdN3JZkhyRZE2SNVdfffV81C1JYvFvUn8MWFFVD2Y4S/jHjV1BVR1fVSurauXy5cvnvUBJ2lxNMiAuB3Ydje/S2n6hqq6tqhva6LuAh891WUnSZE0yIM4C9kyyR5I7A4cAq8czJLn3aPQpwFfb8GnA/km2T7I9sH9rkyQtkIl9iqmqbkzyAoYX9i2AVVV1YZJjgDVVtRp4UZKnADcC1wGHt2WvS/JahpABOKaqrptUrZKkW5tYQABU1SnAKdPajhoNvxx4+QzLrgJWTbI+SdLMFvsmtSRpiTIgJEldBoQkqcuAkCR1GRCSpC4DQpLUZUBIkroMCElSlwEhSeoyICRJXQaEJKnLgJAkdRkQkqQuA0KS1GVASJK6DAhJUpcBIUnqMiAkSV0GhCSpy4CQJHUZEJKkLgNCktRlQEiSugwISVKXASFJ6jIgJEldBoQkqcuAkCR1GRCSpC4DQpLUNdGASHJAkouTrE1yZGf6nya5KMl5Sf4jye6jaTclOac9Vk+yTknSrW05qRUn2QJ4K/AEYD1wVpLVVXXRaLavACur6kdJ/hj4G+BpbdqPq2rvSdUnSZrdJM8g9gHWVtW6qvopcBJw8HiGqvpUVf2ojZ4J7DLBeiRJG2GSAbEzcNlofH1rm8lzgVNH49skWZPkzCRPnWmhJEe0+dZcffXVt6tgSdLNJnaJaWMkeSawEnjsqHn3qro8yX2ATyY5v6q+MX3ZqjoeOB5g5cqVtSAFS9JmYJJnEJcDu47Gd2ltt5Dk8cArgadU1Q1T7VV1efu7Dvg08NAJ1ipJmmaSAXEWsGeSPZLcGTgEuMWnkZI8FHgHQzhcNWrfPsnWbXgZ8ChgfHNbkjRhE7vEVFU3JnkBcBqwBbCqqi5McgywpqpWA38L3A34pyQA/1VVTwEeCLwjyc8ZQux10z79JEmasIneg6iqU4BTprUdNRp+/AzLfQF40CRrkyTNzm9SS5K6DAhJUpcBIUnqMiAkSV0GhCSpy4CQJHUZEJKkLgNCktRlQEiSugwISVKXASFJ6jIgJEldBoQkqcuAkCR1GRCSpC4DQpLUZUBIkroMCElSlwEhSeoyICRJXQaEJKnLgJAkdRkQkqQuA0KS1GVASJK6DAhJUpcBIUnqMiAkSV0GhCSpa6IBkeSAJBcnWZvkyM70rZN8sE3/YpIVo2kvb+0XJ3niJOuUJN3axAIiyRbAW4EDgb2AQ5PsNW225wLfqapfAd4AHNuW3Qs4BPhV4ADgbW19kqQFMskziH2AtVW1rqp+CpwEHDxtnoOBf2zDHwZ+M0la+0lVdUNVfRNY29YnSVogkwyInYHLRuPrW1t3nqq6EfgesOMcl5UkTdCWi13A7ZXkCOCINnp9kovn/TmOne813sIy4JqJPsP869Y84f00H+Z9Xy/ANi/K8TEP27Ukj+sNbNeca/71X6wwt6+g+bEsx96ufb37TBMmGRCXA7uOxndpbb151ifZErgHcO0clwWgqo4Hjp+nmhdckjVVtXKx69gYm2LNsGnWvSnWDJtm3ZtizTDZuid5ieksYM8keyS5M8NN59XT5lkNHNaGfxf4ZFVVaz+kfcppD2BP4EsTrFWSNM3EziCq6sYkLwBOA7YAVlXVhUmOAdZU1WrgH4D3JlkLXMcQIrT5PgRcBNwIPL+qbppUrZKkW5voPYiqOgU4ZVrbUaPhnwC/N8OyfwX81STrWyI2xctjm2LNsGnWvSnWDJtm3ZtizTDBujNc0ZEk6ZbsakOS1GVAzLMkq5JcleSCUdsOSU5Pckn7u31rT5I3ty5FzkvysNEyh7X5L0lyWO+5FqDuv03ytVbbyUnu2dpXJPlxknPa47jRMg9Pcn7bpje3Lz4uZM1HJ7l8VNtBo2nd7ls21CXMAtX9wVHNlyY5p7UvlX29a5JPJbkoyYVJ/qS1L9lje5aal/pxPVPdC39sV5WPeXwAjwEeBlwwavsb4Mg2fCRwbBs+CDgVCPBI4IutfQdgXfu7fRvefhHq3h/Ysg0fO6p7xXi+aev5UtuWtG07cIFrPhp4WWfevYBzga2BPYBvMHx4Yos2fB/gzm2evRZ6X0+b/v+Ao5bYvr438LA2vB3w9bZPl+yxPUvNS/24nqnuBT+2PYOYZ1V1BsMnssbGXYr8I/DUUft7anAmcM8k9waeCJxeVddV1XeA0xn6pFrQuqvqEzV8wx3gTIbvo8yo1X73qjqzhiP3Pdy8rfNuhn09k5m6b5lLlzDzara62zvT3wdOnG0di7Cvr6yqL7fhHwBfZejdYMke2zPVvAkc1zPt65lM7Ng2IBbGvarqyjb838C92vBMXYosxa5GnsPwzmnKHkm+kuQzSR7d2nZmqHXKYtX9gnb5YNXUJQ82nX39aODbVXXJqG1J7esMvS4/FPgim8ixPa3msSV9XHfqXtBj24BYYO0dyCb10bEkr2T4Psr7W9OVwG5V9VDgT4EPJLn7YtU3zduB+wJ7M9T5/xa1mo13KLc8e1hS+zrJ3YCPAC+uqu+Ppy3VY3ummpf6cd2pe8GPbQNiYXy7naZOna5e1dpn6lJkzl2NTFqSw4EnAc9oLwC0U9lr2/DZDNc579dqHJ+uL3jdVfXtqrqpqn4OvJObewHeFPb1lsD/Aj441baU9nWSrRhesN5fVR9tzUv62J6h5iV/XPfqXpRje1I3WjbnB9NudgF/yy1v5P1NG/4tbnkj70utfQfgmww38bZvwzssQt0HMHybffm0+ZYDW7Th+7SDboc2Pv1m3kELXPO9R8MvYbg2C8Nvi4xv5K1juIm3ZRveg5tv5P3qQu/r0f7+zFLc1+053gO8cVr7kj22Z6l5SR/Xs9S94Mf2RP8TbI4PhssDVwI/Y7jm91yGLsz/A7gE+PfRQReGH1X6BnA+sHK0nucw3GxaCzx7kepey3AN85z2OK7N+zvAha3ty8CTR+tZCVzQtukttC9jLmDN72378jyGPr3G/6le2eq6mNGnUBg+cfP1Nu2Vi7GvW/sJwPOmzbtU9vW+DJePzhsdDwct5WN7lpqX+nE9U90Lfmz7TWpJUpf3ICRJXQaEJKnLgJAkdRkQkqQuA0KS1GVAaKMlqSTvG41vmeTqJP+6mHVNSfKF9ndFkqffjvVcmmTZ/FX2i/UeneRlM0x7XpI/uK3LL1VJTpnqNVWbjon+opzusH4I/FqSbavqx8ATWKRvH/dU1W+0wRXA04EPLF41c5dky6o6bsNzLpxW040bnnN2VXXQhufSUuMZhG6rUxi+LQvT+g9KctfWmdiXWsdnB7f2FUk+m+TL7fEbrX2/JJ9O8uHWT//7e/3tt3nekGRNkq8m+R9JPprhdwX+cjTf9W3wdcCjW9/5L0myTZJ3t379v5LkcW3+LZL8XZILWkdoLxw97QtbrecneUCbf4ck/9zmPTPJg1v70W27P51kXZIXjWp6ZZKvJ/kccP9p2/TGJGuAPxmfHST530nOSnJuko8kucts/yBJlrf5zmqPR7X2f5k6K0nyR0neP3ruN7X9c0GSfUbb8d4kn2f4zfiZ1vvY3PzbBF9Jsl2Seyc5Y7TOR7d5f3E2luRP27QLkrx4dGx8Nck7M/wGwieSbDvb9moBTPpboz7ueA/geuDBwIeBbRi+6bkf8K9t+l8Dz2zD92T4JuddgbsA27T2PYE1bXg/4HsMfcXcCfhPYN/O836am/vu/xPgCoa+87dm+EbyjlP1jdb7r6PlXwqsasMPAP6r1f/HbVumfiNg6tvAlwIvbMP/B3hXG/574NVt+H8C57Tho4EvtHqWAdcCWwEPZ/gG7F2AuzN8k/dlo21626jGo0fTdhy1/+Woll/MM23/fGBqvwG7AV9tw/dqz/no9m+xw+i539mGH0Pr+qOt/2xg2w2s92PAo9rw3RiuSLyU9o1dhu4ethvty2WjfXHXtsyFDL2VrmDoOG/vNv+HaMeQj8V7eIlJt0lVnZehK+JDGc4mxvYHnjK6Tr4NwwvLFcBbkuwN3MTQEdqUL1XVeoAMv6a2Avhc56lXt7/nAxdW62o6yTqGjsmunaXsfRle3KmqryX5Vqvh8QzdLdzYpo1/q2Gqg7ezGTrSm1rP77R5P5lkx9zc6+fHq+oG4IYkVzG8OD8aOLmqftRqXc0tfZC+X2tnRvdkeDE9bZZto23HXqOTr7snuVtVfTvJUcCngN+etn0ntu04I8ndc/N9gtU1XD6ccb3A54HXtzOSj1bV+iRnAasydDb3z1V1zrQa92374odtX3yUYf+sBr45mv9shmNAi8iA0O2xGvg7hnfqO47aA/xOVV08njnJ0cC3gYcwnCn8ZDT5htHwTcx8bE7N9/Npy/x8lmVuj6nnmK2m3vwbs8wPZ2g/AXhqVZ2boffR/TawnjsBj6yqn3SmPYghPHea1j69r52p8XFNM633dUk+ztDfz+eTPLEFzWMYLj+ekOT1VfWeDdQ9Zfq+8xLTIvMehG6PVcBrqur8ae2nMVy7D0CSh7b2ewBX1tBd8bMYLkFM0g8YfrJxymeBZ7Sa7sdwVnMxw6+a/VGG7rZJssMG1jtez37ANTXttxGmOQN4apJtk2wHPHmO9W8HXNnejT9jDvN/AvjF/ZN2pka7t3Agw6WclyXZY7TM09o8+wLfq6rvbcR671tV51fVscBZwAOS7M7wg0fvBN7F8NOqY59l2Bd3SXJX4Ldbm5YgA0K3WVWtr6o3dya9luHa+3lJLmzjAG8DDktyLsM9gJneOc+X84Cb2k3el7Tnv1OS8xku6xzeLge9i+F+xHmttg19NPZo4OFJzmO4EX7YbDPX8PORH2TobvlUhhfTufgLhl8S+zzwtTnM/yJgZbt5fhHwvCRbM/x2wHOq6grafZip8AZ+kuQrwHEMveHOab2t/cXtRvN5DD3TnspwlnNuW+fTgDeNV9T2xQkM3Wd/keG+zlfmsG1aBPbmKm2mknya4Wb3msWuRUuTZxCSpC7PICRJXZ5BSJK6DAhJUpcBIUnqMiAkSV0GhCSpy4CQJHX9f5b5qMz1qMBRAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# get mitochondrial genes\n",
    "mitochondrial_gene_list = np.array([g.startswith('MT') for g in iPSC_data.columns])\n",
    "mitochondrial_gene_list\n",
    "#mitochondrial_gene_list\n",
    "\n",
    "# get expression\n",
    "mito_exp = iPSC_data.loc[:,mitochondrial_gene_list].mean(axis=1)\n",
    "\n",
    "# plotting\n",
    "fig, ax = plt.subplots(1, figsize=(6,6))\n",
    "\n",
    "ax.hist(mito_exp, bins=45)\n",
    "ax.axvline(np.percentile(mito_exp, 90), color= 'red')\n",
    "ax.set_xlabel('Mean mitochondrial expression')\n",
    "ax.set_ylabel('# of cells')\n",
    "ax.set_title('Mitochondrial expression')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "prescribed-north",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "genes_per_cell = np.sum(iPSC_data_T > 0)\n",
    "\n",
    "fig, ax = plt.subplots(1, figsize=(8,8))\n",
    "ax.hist(iPSC_data_T, bins=50)\n",
    "ax.set_xlabel('Genes')\n",
    "ax.set_ylabel('Frequency')\n",
    "ax.set_yscale('symlog')\n",
    "ax.set_title('Gene detection across Samples')\n",
    "fig.tight_layout()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "spoken-calculation",
   "metadata": {},
   "source": [
    "## Figure A"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "robust-times",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "iPSC_data_T_log = scprep.transform.log(iPSC_data_T)\n",
    "\n",
    "genes_per_cell = np.sum(iPSC_data_T_log > 0)\n",
    "\n",
    "fig, ax = plt.subplots(1, figsize=(8,8))\n",
    "ax.hist(iPSC_data_T_log, bins=50)\n",
    "ax.set_xlabel('Genes')\n",
    "ax.set_ylabel('Frequency')\n",
    "ax.set_yscale('symlog')\n",
    "ax.set_title('Gene detection across Samples')\n",
    "fig.tight_layout()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "consecutive-professional",
   "metadata": {},
   "source": [
    "## Figure B "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "opening-collective",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0.5, 1.0, 'Mitochondrial expression')"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYIAAAFNCAYAAAANRGjoAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/Il7ecAAAACXBIWXMAAAsTAAALEwEAmpwYAAAfG0lEQVR4nO3de7wcdX3/8debJEC4X3JUCBwOIGBRETBFlIuxSAkRia2oIGJAbMQKiIVaBETgZ/sAaxEoCg0auQooFxskFFC5Wy4J5EqIhBBKSAQSJBBuEvj8/pjvIcOyZ8/mMrvn5Pt+Ph77OLMz35n57GSy752Z3e8oIjAzs3yt0e4CzMysvRwEZmaZcxCYmWXOQWBmljkHgZlZ5hwEZmaZcxDYKiPpQknfrWC5t0v66qpebg/rCknvbTC96dfYyrpbSdJNkka3uw5bdQa2uwDr+yTNBTYHNo+IhaXxDwE7A1tHxNyIOKo0bThweURs0dJiK1Z+jbmKiP3bXYOtWj4isGY9DhzS/UTSB4F12ldO60ka0O4alld/rNlaz0FgzboM+HLp+Wjg0nIDSRdL+r6kdYGbgM0lLUmPzSWtJekcSfPT4xxJa5XmHyVpsqQXJD0maURp8VtJukfSi5JukTSkNN+BkmZIej6djvmr0rS5kk6QNFXSYklXS1q7NP2fJS1I9Xylzuu5QNIESS8Bn+h+jWn6xpJ+I+lZSX9Ow00dAUlaQ9KJ6XUukvRLSZukaRdIurbU9ixJv1NhuKR5kk6StDC9vkN7qXlzSdemOh+XdGyp/W6SJqZt/rSks9P4tSVdnmp7XtIDkt6dpr11yiu9jlMkPSHpGUmXStowTetKp9pGS/q/VO/JzWwfay0HgTXrXmADSX+VPmUeDFxer2FEvATsD8yPiPXSYz5wMrA7xemkDwG7AadA8YZEESz/DGwE7A3MLS32i8ARwLuANYET0nzbA1cCxwEdwATgBklrlub9PDAC2BrYCTg8zTsiLWdfYDvgk3VezheBfwXWB+6umbYG8HNgK6ATeAU4v942qeMY4DPAxylOu/0Z+HGadjzwQUmHS9oLOBIYHcv6g3kPMAQYShHIYyXt0EPNfwBuAKak9vsAx0naL7U9Fzg3IjYAtgV+mcaPBjYEtgQ2BY5Kr6/W4enxCWAbYL0622BPYIe07lPLQW19g4PAlkf3UcG+wEzgqeWc/1DgjIh4JiKeBU4HDkvTjgTGRcStEfFmRDwVEY+U5v15RPwxIl6heLPaOY3/AnBjmu914IfAYOBjpXnPi4j5EfEcxZti97yfT8udnsLrtDo1/3dE3JNqerU8ISIWRcS1EfFyRLxI8eb78Sa3xVHAyRExLyJeS+s+SNLAiHg5bZezKcL2mIiYVzP/dyPitYi4A7gxvZZ31Ax8EOiIiDMi4i8RMQe4iCLIAV4H3itpSEQsiYh7S+M3Bd4bEW9ExKSIeKHO6zgUODsi5kTEEuA7wMGSytcfT4+IVyJiCkUgfajJbWQt4iCw5XEZxafNw6k5LdSkzYEnSs+fSOOg+OT5WIN5/1Qafpnik+c7lpne/J6k+PTbzLxP1tRT68k64wCQtI6k/0qnRV4A7gQ2UnPn5bcCrk+nXZ6nCNY3gHen13EfMAcQyz6ld/tzCq5y3ZuXnpdr3oriFN3zpXWd1L0eigDeHngknf45II2/DLgZuCqdNvuBpEF1Xke9f9OBpeVDz9vf+ggHgTUtIp6guGg8Eriut+Z1xs2neGPq1pnGQfHmte0KlPW2ZUoSRag0c7SyILUt11OrUfe8x1Oc8vhIOrWyd3cZTaz7SWD/iNio9Fg7Ip4CkPQNYC2K1/ftmnk3VnEdplz3/NLzcs1PAo/XrGf9iBgJEBGPRsQhFKfczgKukbRuRLweEadHxI4UR1cH8PZrRN3q/ZsuBZ5uYhtYH+EgsOV1JPA3NZ9I63ka2LT7wmFyJXCKpI50sfdUll1n+BlwhKR90gXIoZLe10Q9vwQ+leYbRPHm/BrFufFm5j1c0o6S1gG+18Q8ZetTnDd/Pl3oXZ75LwT+VdJWAGmbjErD2wPfB75EcYro25J2rpn/dElrpmsIBwC/6mE99wMvSvoXSYMlDZD0AUl/ndb1JUkd6Ujq+TTPm5I+IemD6ejmBYpTRW/WWf6VwLckbS1pPeDfgKsjYulybAtrMweBLZeIeCwiJjbR7hGKN4k56ZTE5hRvbhOBqcA04ME0joi4n+Ji8I+AxcAdvP2TZk/rmUXxhvmfwELg08CnI+IvTcx7E3AO8Htgdvq7PM6huB6xkOJi+v8sx7znAuOBWyS9mOb/SDq3fjlwVkRMiYhHKU7lXKZl37D6E8XF5fnAFcBRNddT3hIRb1AExc4UR3MLgZ9SXAiG4iL6DElLUk0Hp+sw7wGuoQiBmRT/HpfVWcW4NP7OtPxXKS6EWz8i35jGrP/QavpDPWsvHxGYmWXOQWBmljmfGjIzy5yPCMzMMucgMDPLXL/rhnrIkCHR1dXV7jLMbHU3a1bxd4cdGrfrJyZNmrQwIjrqTet3QdDV1cXEib1+jd3MbOUMH178vf32dlaxykiq14UK4FNDZmbZcxCYmWXOQWBmljkHgZlZ5hwEZmaZcxCYmWXOQWBmlrnKgkDS2pLulzRF0gxJp9dps5akqyXNlnSfpK6q6jEzs/qqPCJ4jeJOVh+iuCnGCEm717Q5kuL+q++luCHJWRXWY2ZmdVQWBFFYkp4OSo/ark5HAZek4WuAfdI9Z83MrEUqvUaQ7o86GXgGuDUi7qtpMpTi5tqke5wuBjatsiYzM3u7SvsaSvdL3VnSRsD1kj4QEdOXdzmSxgBjADo7O1dtkbba6Trxxrate+6Zn2rbunNT9b/zVXMWAXBwzXpWx3/jlnxrKCKeB26juFF22VPAlgDppt0bAovqzD82IoZFxLCOjrqd55mZ2Qqq8ltDHelIAEmDgX2BR2qajQdGp+GDgN+Hb5lmZtZSVZ4a2gy4RNIAisD5ZUT8RtIZwMSIGA/8DLhM0mzgOeDgCusxM7M6KguCiJgK7FJn/Kml4VeBz1VVg5mZ9c6/LDYzy5yDwMwscw4CM7PMOQjMzDLnIDAzy5yDwMwscw4CM7PMOQjMzDLnIDAzy5yDwMwscw4CM7PMOQjMzDLnIDAzy5yDwMwscw4CM7PMOQjMzDLnIDAzy5yDwMwscw4CM7PMOQjMzDLnIDAzy5yDwMwscw4CM7PMOQjMzDLnIDAzy5yDwMwscw4CM7PMOQjMzDLnIDAzy5yDwMwscw4CM7PMOQjMzDLnIDAzy5yDwMwsc5UFgaQtJd0m6WFJMyR9s06b4ZIWS5qcHqdWVY+ZmdU3sMJlLwWOj4gHJa0PTJJ0a0Q8XNPurog4oMI6zMysgcqOCCJiQUQ8mIZfBGYCQ6tan5mZrZiWXCOQ1AXsAtxXZ/JHJU2RdJOk97eiHjMzW6bKU0MASFoPuBY4LiJeqJn8ILBVRCyRNBL4NbBdnWWMAcYAdHZ2VluwmVlmKj0ikDSIIgSuiIjraqdHxAsRsSQNTwAGSRpSp93YiBgWEcM6OjqqLNnMLDtVfmtIwM+AmRFxdg9t3pPaIWm3VM+iqmoyM7N3qvLU0B7AYcA0SZPTuJOAToCIuBA4CPi6pKXAK8DBEREV1mRmZjUqC4KIuBtQL23OB86vqgYzM+udf1lsZpY5B4GZWeYcBGZmmXMQmJllzkFgZpY5B4GZWeYcBGZmmXMQmJllzkFgZpY5B4GZWeYcBGZmmXMQmJllzkFgZpY5B4GZWeYcBGZmmXMQmJllzkFgZpY5B4GZWeYcBGZmmXMQmJllzkFgZpY5B4GZWeYcBGZmmXMQmJllzkFgZpY5B4GZWeYcBGZmmXMQmJllzkFgZpY5B4GZWeYcBGZmmXMQmJllzkFgZpY5B4GZWeYqCwJJW0q6TdLDkmZI+madNpJ0nqTZkqZK2rWqeszMrL6BFS57KXB8RDwoaX1gkqRbI+LhUpv9ge3S4yPABemvmZm1SGVHBBGxICIeTMMvAjOBoTXNRgGXRuFeYCNJm1VVk5mZvVNLrhFI6gJ2Ae6rmTQUeLL0fB7vDAszM6tQlaeGAJC0HnAtcFxEvLCCyxgDjAHo7OxchdWZrR66TryxLeude+an2rJeW7UqPSKQNIgiBK6IiOvqNHkK2LL0fIs07m0iYmxEDIuIYR0dHdUUa2aWqSq/NSTgZ8DMiDi7h2bjgS+nbw/tDiyOiAVV1WRmZu9U5amhPYDDgGmSJqdxJwGdABFxITABGAnMBl4GjqiwHjMzq6OyIIiIuwH10iaAb1RVg5mZ9c6/LDYzy5yDwMwscw4CM7PMOQjMzDLnIDAzy5yDwMwscw4CM7PMOQjMzDLnIDAzy5yDwMwsc70GgaR1Ja2RhreXdGDqVdTMzFYDzRwR3AmsLWkocAtFR3IXV1mUmZm1TjNBoIh4Gfh74CcR8Tng/dWWZWZmrdJUEEj6KHAo0H0bpAHVlWRmZq3UTBAcB3wHuD4iZkjaBrit0qrMzKxler0fQUTcAdxRej4HOLbKoszMrHV6DAJJNwDR0/SIOLCSiszMrKUaHRH8sGVVmJlZ2/QYBOmUkJmZreYanRqaRv1TQ6K43fBOlVVlZmYt0+jU0AEtq8LMzNqm0amhJ7qHJW0FbBcRv5U0uNF8ZmbWvzTT19A/ANcA/5VGbQH8usKazMyshZr5Qdk3gD2AFwAi4lHgXVUWZWZmrdNMELwWEX/pfiJpIA1+X2BmZv1LM0Fwh6STgMGS9gV+BdxQbVlmZtYqzQTBicCzwDTga8AE4JQqizIzs9Zp5ts/g4FxEXERgKQBadzLVRZmZmat0cwRwe8o3vi7DQZ+W005ZmbWas0EwdoRsaT7SRpep7qSzMyslZoJgpck7dr9RNKHgVeqK8nMzFqpmWsExwG/kjSfop+h9wBfqLIoMzNrnWZuTPOApPcBO6RRsyLi9WrLMjOzVmmqz6D0xj+94lrMzKwNmrlGYGZmq7Eeg0DSHunvWiuyYEnjJD0jqe6RhKThkhZLmpwep67IeszMbOU0OiI4L/393xVc9sXAiF7a3BURO6fHGSu4HjMzWwmNrhG8LmksMFTSebUTI+LYRguOiDslda1kfWZmVrHe7lD2SWA/YFJF6/+opCnAfOCEiJhRr5GkMcAYgM7OzopKMTPLU6M7lC0ErpI0MyKmVLDuB4GtImKJpJEUN7vZrodaxgJjAYYNG+YusM3MVqFmvjW0SNL16cLvM5KulbTFyq44Il7o7roiIiYAgyQNWdnlmpnZ8mkmCH4OjAc2T48b0riVIuk9kpSGd0u1LFrZ5ZqZ2fJp5gdl74qI8hv/xZKO620mSVcCw4EhkuYB3wMGAUTEhcBBwNclLaXou+jgiPBpHzOzFmsmCBZK+hJwZXp+CE18co+IQ3qZfj5wfhPrNzOzCjVzaugrwOeBPwELKD7JH1FlUWZm1jrNdDr3BHBgC2oxM7M2cF9DZmaZcxCYmWXOQWBmlrleg0DSKaXhFeqJ1MzM+q5G3VD/i6SPUnxLqNuK9kRqZmZ9VKNvDT0CfA7YRtJd6fmmknaIiFktqc7MzCrX6NTQ88BJwGyKXwifm8afKOkP1ZZlZmat0uiIYD/gVGBb4GxgKvBSRPjHZGZmq5Eejwgi4qSI2AeYC1wGDAA6JN0t6YYW1WdmZhVrpq+hmyNiIjBR0tcjYk93F21mtvro9eujEfHt0tPD07iFVRVkZmattVw/KKvoTmVmZtZG/mWxmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWucqCQNI4Sc9Imt7DdEk6T9JsSVMl7VpVLWZm1rMqjwguBkY0mL4/sF16jAEuqLAWMzPrQWVBEBF3As81aDIKuDQK9wIbSdqsqnrMzKy+dl4jGAo8WXo+L40zM7MWGtjuApohaQzF6SM6OztXeDldJ964qkpabnPP/FRb1pvjazar0ur4f6qdRwRPAVuWnm+Rxr1DRIyNiGERMayjo6MlxZmZ5aKdQTAe+HL69tDuwOKIWNDGeszMslTZqSFJVwLDgSGS5gHfAwYBRMSFwARgJDAbeBk4oqpazMysZ5UFQUQc0sv0AL5R1frNzKw5/mWxmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZpmrNAgkjZA0S9JsSSfWmX64pGclTU6Pr1ZZj5mZvdPAqhYsaQDwY2BfYB7wgKTxEfFwTdOrI+LoquowM7PGqjwi2A2YHRFzIuIvwFXAqArXZ2ZmK6DKIBgKPFl6Pi+Nq/VZSVMlXSNpywrrMTOzOtp9sfgGoCsidgJuBS6p10jSGEkTJU189tlnW1qgmdnqrsogeAoof8LfIo17S0QsiojX0tOfAh+ut6CIGBsRwyJiWEdHRyXFmpnlqsogeADYTtLWktYEDgbGlxtI2qz09EBgZoX1mJlZHZV9aygilko6GrgZGACMi4gZks4AJkbEeOBYSQcCS4HngMOrqsfMzOqrLAgAImICMKFm3Kml4e8A36myBjMza6zdF4vNzKzNHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZplzEJiZZc5BYGaWOQeBmVnmHARmZpmrNAgkjZA0S9JsSSfWmb6WpKvT9PskdVVZj5mZvVNlQSBpAPBjYH9gR+AQSTvWNDsS+HNEvBf4EXBWVfWYmVl9VR4R7AbMjog5EfEX4CpgVE2bUcAlafgaYB9JqrAmMzOrUWUQDAWeLD2fl8bVbRMRS4HFwKYV1mRmZjUUEdUsWDoIGBERX03PDwM+EhFHl9pMT23mpeePpTYLa5Y1BhiTnu4AzKqk6OoMARb22qrv6Y9198eaoX/W3R9rhv5Z96qoeauI6Kg3YeBKLriRp4AtS8+3SOPqtZknaSCwIbCodkERMRYYW1GdlZM0MSKGtbuO5dUf6+6PNUP/rLs/1gz9s+6qa67y1NADwHaStpa0JnAwML6mzXhgdBo+CPh9VHWIYmZmdVV2RBARSyUdDdwMDADGRcQMSWcAEyNiPPAz4DJJs4HnKMLCzMxaqMpTQ0TEBGBCzbhTS8OvAp+rsoY+or+e1uqPdffHmqF/1t0fa4b+WXelNVd2sdjMzPoHdzFhZpY5B8EKkjRO0jPpK7Dd4zaRdKukR9PfjdN4STovdaUxVdKupXlGp/aPShpdb10V1/zvkh5JdV0vaaM0vkvSK5Imp8eFpXk+LGlaej3nVf0jwB7qPk3SU6X6RpamfSfVNkvSfqXxDbs8aUHNV5fqnStpchrfl7b1lpJuk/SwpBmSvpnG99l9u0HNfXrfblB36/ftiPBjBR7A3sCuwPTSuB8AJ6bhE4Gz0vBI4CZAwO7AfWn8JsCc9HfjNLxxi2v+W2BgGj6rVHNXuV3Ncu5Pr0Ppde3fhm19GnBCnbY7AlOAtYCtgccovqwwIA1vA6yZ2uzYypprpv8HcGof3NabAbum4fWBP6Zt2mf37QY19+l9u0HdLd+3fUSwgiLiTopvOpWVu8y4BPhMafylUbgX2EjSZsB+wK0R8VxE/Bm4FRjRypoj4pYoftUNcC/F7z16lOreICLujWLvvJRlr7MSPWzrnowCroqI1yLicWA2RXcnzXR5sso0qjl9yvw8cGWjZbRpWy+IiAfT8IvATIoeAPrsvt1TzX19326wrXtS2b7tIFi13h0RC9Lwn4B3p+GeuttophuOVvoKxaegbltLekjSHZL2SuOGUtTZrZ01H50O+8d1n6qgf2zrvYCnI+LR0rg+t61V9Aa8C3Af/WTfrqm5rE/v23Xqbum+7SCoSPpE0W++kiXpZGApcEUatQDojIhdgH8CfiFpg3bVV8cFwLbAzhS1/kdbq1k+h/D2o4E+t60lrQdcCxwXES+Up/XVfbunmvv6vl2n7pbv2w6CVevpdHjZfZj5TBrfU3cbzXTDUTlJhwMHAIem/+Skw89FaXgSxTnI7VN95UPsttQcEU9HxBsR8SZwEcXhMfT9bT0Q+Hvg6u5xfW1bSxpE8cZ0RURcl0b36X27h5r7/L5dr+627NtVXQjJ4UHNRSfg33n7BbUfpOFP8fYLaven8ZsAj1NcTNs4DW/S4ppHAA8DHTXtOoABaXibtGNtkp7XXlAb2YZtvVlp+FsU504B3s/bL6jNobiYNjANb82yC2rvb2XNpe19R1/d1mk9lwLn1Izvs/t2g5r79L7doO6W79uV7VCr+4Pi0H4B8DrFObkjKbrQ/h3wKPDb0s4lipv0PAZMA4aVlvMVios+s4Ej2lDzbIrzi5PT48LU9rPAjDTuQeDTpeUMA6an13M+6YeJLa77srQtp1L0WVX+z3Nyqm0WpW99UHzD5Y9p2smtrjmNvxg4qqZtX9rWe1Kc9pla2idG9uV9u0HNfXrfblB3y/dt/7LYzCxzvkZgZpY5B4GZWeYcBGZmmXMQmJllzkFgZpY5B4HVJSkkXV56PlDSs5J+0866ukn6Q/rbJemLK7GcuZKGrLrK3lruaZJO6GHaUZK+vKLz91WSJnT38Gn9S6V3KLN+7SXgA5IGR8QrwL604Ze4PYmIj6XBLuCLwC/aV03zJA2MiAt7b9k6qaalvbdsLCJG9t7K+iIfEVgjEyh+OQo1/eNIWjd1iHV/6rxrVBrfJekuSQ+mx8fS+OGSbpd0Teoj/op6fb2nNj+SNFHSTEl/Lek6FX3af7/UbkkaPBPYK/Xb/i1Ja0v6eepT/iFJn0jtB0j6oaTpqTOvY0qrPSbVOk3S+1L7TST9OrW9V9JOafxp6XXfLmmOpGNLNZ0s6Y+S7gZ2qHlN50iaCHyz/Glf0j9IekDSFEnXSlqn0T+IpI7U7oH02CON/+/uowxJX5N0RWnd56btM13SbqXXcZmkeyjuG97Tcj+uZf3iPyRpfUmbSbqztMy9Utu3jq4k/VOaNl3ScaV9Y6aki1T0v3+LpMGNXq+1SJW/UvSj/z6AJcBOwDXA2hS/ehwO/CZN/zfgS2l4I4pfNa4LrAOsncZvB0xMw8OBxRT9oKwB/C+wZ5313s6yfuO/Ccyn6Ld9LYpf6G7aXV9pub8pzX88MC4Nvw/4v1T/19Nr6e6fvvuXsXOBY9LwPwI/TcP/CXwvDf8NMDkNnwb8IdUzBFgEDAI+TPFr0HWADSh+1XpC6TX9pFTjaaVpm5bGf79Uy1ttarbPL7q3G9AJzEzD707r3Cv9W2xSWvdFaXhvUpcXafmTgMG9LPcGYI80vB7FWYTjSb9epejiYP3SthxS2hbrpnlmUPSs2UXR+dvOqf0vSfuQH+19+NSQ9SgipqroHvcQiqODsr8FDiydx16b4g1kPnC+pJ2BNyg68+p2f0TMA1Bxd64u4O46qx6f/k4DZkTq/ljSHIrOtRY1KHtPijdxIuIRSU+kGj5J0cXA0jStfK+A7k7KJlF0CNe9nM+mtr+XtKmW9VB5Y0S8Brwm6RmKN+G9gOsj4uVU63je7mrq+0A60tmI4k3z5gavjfQ6diwdTG0gab2IeFrSqcBtwN/VvL4r0+u4U9IGWnYef3wUp/16XC5wD3B2OsK4LiLmSXoAGKeiw7RfR8Tkmhr3TNvipbQtrqPYPuOBx0vtJ1HsA9ZmDgLrzXjghxSfvDctjRfw2YiYVW4s6TTgaeBDFJ/8Xy1Nfq00/AY973/d7d6smefNBvOsjO51NKqpXvvlmeelHsZfDHwmIqao6ClzeC/LWQPYPSJerTPtgxQhuXnN+Np+ZLqfl2vqablnSrqRoi+beyTtlwJlb4rThhdLOjsiLu2l7m61286nhvoAXyOw3owDTo+IaTXjb6Y4ty4ASbuk8RsCC6LoQvcwilMHVXqR4jZ/3e4CDk01bU9xlDKL4g5ZX1PRDTSSNullueXlDAcWRk2//DXuBD4jabCk9YFPN1n/+sCC9On60Cba3wK8dX0jHXmRzv3vT3EK5gRJW5fm+UJqsyewOCIWL8dyt42IaRFxFvAA8D5JW1HcWOci4KcUt+Qsu4tiW6wjaV3g79I466McBNZQRMyLiPPqTPp/FOfGp0qakZ4D/AQYLWkKxTn6nj4JrypTgTfSxdZvpfWvIWkaxemYw9NpnJ9SXC+Ymmrr7SunpwEfljSV4oL06EaNo7jl4NUUXQDfRPGm2YzvUtyV6h7gkSbaHwsMSxexHwaOkrQWRb/1X4mI+aTrJN0hDbwq6SHgQoqeW5tabhp/XLrgO5WiJ9WbKI5apqRlfgE4t7ygtC0upujS+T6K6y4PNfHarE3c+6jZakzS7RQXnSe2uxbru3xEYGaWOR8RmJllzkcEZmaZcxCYmWXOQWBmljkHgZlZ5hwEZmaZcxCYmWXu/wNwQKHjuw/WYwAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# get mitochondrial genes\n",
    "mitochondrial_gene_list = np.array([g.startswith('MT') for g in iPSC_data.columns])\n",
    "mitochondrial_gene_list\n",
    "#mitochondrial_gene_list\n",
    "\n",
    "# get expression\n",
    "mito_exp = iPSC_data.loc[:,mitochondrial_gene_list].mean(axis=1)\n",
    "\n",
    "# plotting\n",
    "fig, ax = plt.subplots(1, figsize=(6,5))\n",
    "\n",
    "ax.hist(mito_exp, bins=10)\n",
    "ax.axvline(np.percentile(mito_exp, 90), color = 'red')\n",
    "ax.set_xlabel('Mean mitochondrial expression')\n",
    "ax.set_ylabel('# of cells')\n",
    "ax.set_title('Mitochondrial expression')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "noticed-representation",
   "metadata": {},
   "source": [
    "#### Transforming the data\n",
    "- The purpose of transforming data is to make sure that each gene or feature in our counts matrix is counted equally. \n",
    "- Genes that are more highly expressed (i.e. have larger values) will be considered more important and will have a larger impact on downstream analysis.\n",
    "    - Many Transform options: scprep.transform.log(), scprep.transform.sqrt() or scprep.transform.arcsinh()."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "illegal-timber",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>5S_rRNA</th>\n",
       "      <th>7SK</th>\n",
       "      <th>A1BG</th>\n",
       "      <th>A1BG-AS1</th>\n",
       "      <th>A1CF</th>\n",
       "      <th>A2M</th>\n",
       "      <th>A2M-AS1</th>\n",
       "      <th>A2ML1</th>\n",
       "      <th>A2MP1</th>\n",
       "      <th>A3GALT2</th>\n",
       "      <th>...</th>\n",
       "      <th>hsa-mir-8072</th>\n",
       "      <th>snR65</th>\n",
       "      <th>snoR442</th>\n",
       "      <th>snoU109</th>\n",
       "      <th>snoU13</th>\n",
       "      <th>snoU2-30</th>\n",
       "      <th>snoU2_19</th>\n",
       "      <th>snoZ13_snr52</th>\n",
       "      <th>snoZ185</th>\n",
       "      <th>snoZ5</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P1</th>\n",
       "      <td>1.732051</td>\n",
       "      <td>10.723805</td>\n",
       "      <td>1.732051</td>\n",
       "      <td>7.681146</td>\n",
       "      <td>0.0</td>\n",
       "      <td>60.547502</td>\n",
       "      <td>6.082763</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>4.123106</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>4.358899</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.872983</td>\n",
       "      <td>11.532563</td>\n",
       "      <td>6.082763</td>\n",
       "      <td>7.211103</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_HPAH</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>8.544004</td>\n",
       "      <td>1.732051</td>\n",
       "      <td>7.416198</td>\n",
       "      <td>0.0</td>\n",
       "      <td>25.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>2.645751</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.828427</td>\n",
       "      <td>7.549834</td>\n",
       "      <td>4.358899</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_Carrier</th>\n",
       "      <td>1.414214</td>\n",
       "      <td>9.055385</td>\n",
       "      <td>2.236068</td>\n",
       "      <td>5.477226</td>\n",
       "      <td>0.0</td>\n",
       "      <td>18.165902</td>\n",
       "      <td>2.828427</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>2.236068</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.472136</td>\n",
       "      <td>8.426150</td>\n",
       "      <td>5.196152</td>\n",
       "      <td>5.916080</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_Carrier</th>\n",
       "      <td>2.236068</td>\n",
       "      <td>11.180340</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>4.898979</td>\n",
       "      <td>0.0</td>\n",
       "      <td>15.620499</td>\n",
       "      <td>3.464102</td>\n",
       "      <td>1.414214</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>5.291503</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.236068</td>\n",
       "      <td>13.190906</td>\n",
       "      <td>7.280110</td>\n",
       "      <td>8.366600</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.414214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_Carrier</th>\n",
       "      <td>2.449490</td>\n",
       "      <td>10.908712</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>7.416198</td>\n",
       "      <td>0.0</td>\n",
       "      <td>86.371292</td>\n",
       "      <td>3.316625</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>2.449490</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.645751</td>\n",
       "      <td>9.848858</td>\n",
       "      <td>7.937254</td>\n",
       "      <td>10.198039</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P3</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>8.426150</td>\n",
       "      <td>3.316625</td>\n",
       "      <td>8.062258</td>\n",
       "      <td>0.0</td>\n",
       "      <td>52.924474</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>4.242641</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.872983</td>\n",
       "      <td>10.198039</td>\n",
       "      <td>5.291503</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.414214</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P2</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>2.645751</td>\n",
       "      <td>10.148892</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11.224972</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.414214</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>2.645751</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.872983</td>\n",
       "      <td>11.874342</td>\n",
       "      <td>8.426150</td>\n",
       "      <td>10.862780</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_Ctrl</th>\n",
       "      <td>2.236068</td>\n",
       "      <td>8.602325</td>\n",
       "      <td>2.449490</td>\n",
       "      <td>7.615773</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.605551</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>2.645751</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.162278</td>\n",
       "      <td>11.090537</td>\n",
       "      <td>4.358899</td>\n",
       "      <td>4.898979</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_Ctrl</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>12.247449</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>8.366600</td>\n",
       "      <td>0.0</td>\n",
       "      <td>138.387138</td>\n",
       "      <td>2.449490</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.414214</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>2.449490</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.324555</td>\n",
       "      <td>10.630146</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>5.567764</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.414214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_HPAH</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>12.041595</td>\n",
       "      <td>2.236068</td>\n",
       "      <td>3.872983</td>\n",
       "      <td>0.0</td>\n",
       "      <td>111.377736</td>\n",
       "      <td>2.449490</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1.732051</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.236068</td>\n",
       "      <td>7.874008</td>\n",
       "      <td>4.358899</td>\n",
       "      <td>5.656854</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_Ctrl</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>10.099505</td>\n",
       "      <td>2.236068</td>\n",
       "      <td>8.544004</td>\n",
       "      <td>1.0</td>\n",
       "      <td>143.237565</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>2.828427</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.196152</td>\n",
       "      <td>10.099505</td>\n",
       "      <td>4.898979</td>\n",
       "      <td>6.928203</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.236068</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11 rows × 34706 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               5S_rRNA        7SK      A1BG   A1BG-AS1  A1CF         A2M  \\\n",
       "Fam1_HPAH_P1  1.732051  10.723805  1.732051   7.681146   0.0   60.547502   \n",
       "Fam3_HPAH     1.000000   8.544004  1.732051   7.416198   0.0   25.000000   \n",
       "Fam3_Carrier  1.414214   9.055385  2.236068   5.477226   0.0   18.165902   \n",
       "Fam1_Carrier  2.236068  11.180340  1.000000   4.898979   0.0   15.620499   \n",
       "Fam2_Carrier  2.449490  10.908712  0.000000   7.416198   0.0   86.371292   \n",
       "Fam1_HPAH_P3  1.000000   8.426150  3.316625   8.062258   0.0   52.924474   \n",
       "Fam1_HPAH_P2  1.000000  10.000000  2.645751  10.148892   0.0   11.224972   \n",
       "Fam1_Ctrl     2.236068   8.602325  2.449490   7.615773   0.0    3.605551   \n",
       "Fam2_Ctrl     1.000000  12.247449  2.000000   8.366600   0.0  138.387138   \n",
       "Fam2_HPAH     1.000000  12.041595  2.236068   3.872983   0.0  111.377736   \n",
       "Fam3_Ctrl     1.000000  10.099505  2.236068   8.544004   1.0  143.237565   \n",
       "\n",
       "               A2M-AS1     A2ML1     A2MP1  A3GALT2  ...  hsa-mir-8072  snR65  \\\n",
       "Fam1_HPAH_P1  6.082763  1.000000  4.123106      0.0  ...      4.358899    1.0   \n",
       "Fam3_HPAH     1.000000  0.000000  1.000000      0.0  ...      2.645751    0.0   \n",
       "Fam3_Carrier  2.828427  1.000000  1.000000      0.0  ...      2.236068    0.0   \n",
       "Fam1_Carrier  3.464102  1.414214  0.000000      0.0  ...      5.291503    0.0   \n",
       "Fam2_Carrier  3.316625  0.000000  0.000000      1.0  ...      2.449490    0.0   \n",
       "Fam1_HPAH_P3  1.000000  1.000000  0.000000      0.0  ...      4.242641    0.0   \n",
       "Fam1_HPAH_P2  4.000000  1.414214  0.000000      0.0  ...      2.645751    0.0   \n",
       "Fam1_Ctrl     1.000000  0.000000  0.000000      1.0  ...      2.645751    0.0   \n",
       "Fam2_Ctrl     2.449490  1.000000  1.414214      0.0  ...      2.449490    0.0   \n",
       "Fam2_HPAH     2.449490  0.000000  0.000000      0.0  ...      1.732051    1.0   \n",
       "Fam3_Ctrl     2.000000  0.000000  0.000000      0.0  ...      2.828427    0.0   \n",
       "\n",
       "              snoR442   snoU109     snoU13  snoU2-30   snoU2_19  snoZ13_snr52  \\\n",
       "Fam1_HPAH_P1      0.0  3.872983  11.532563  6.082763   7.211103           0.0   \n",
       "Fam3_HPAH         0.0  2.828427   7.549834  4.358899   5.000000           1.0   \n",
       "Fam3_Carrier      0.0  4.472136   8.426150  5.196152   5.916080           0.0   \n",
       "Fam1_Carrier      1.0  2.236068  13.190906  7.280110   8.366600           0.0   \n",
       "Fam2_Carrier      1.0  2.645751   9.848858  7.937254  10.198039           0.0   \n",
       "Fam1_HPAH_P3      1.0  3.872983  10.198039  5.291503   7.000000           0.0   \n",
       "Fam1_HPAH_P2      1.0  3.872983  11.874342  8.426150  10.862780           0.0   \n",
       "Fam1_Ctrl         1.0  3.162278  11.090537  4.358899   4.898979           0.0   \n",
       "Fam2_Ctrl         0.0  6.324555  10.630146  5.000000   5.567764           0.0   \n",
       "Fam2_HPAH         1.0  2.236068   7.874008  4.358899   5.656854           0.0   \n",
       "Fam3_Ctrl         0.0  5.196152  10.099505  4.898979   6.928203           0.0   \n",
       "\n",
       "               snoZ185     snoZ5  \n",
       "Fam1_HPAH_P1  0.000000  0.000000  \n",
       "Fam3_HPAH     0.000000  0.000000  \n",
       "Fam3_Carrier  0.000000  2.000000  \n",
       "Fam1_Carrier  0.000000  1.414214  \n",
       "Fam2_Carrier  0.000000  0.000000  \n",
       "Fam1_HPAH_P3  1.414214  0.000000  \n",
       "Fam1_HPAH_P2  0.000000  0.000000  \n",
       "Fam1_Ctrl     0.000000  0.000000  \n",
       "Fam2_Ctrl     0.000000  1.414214  \n",
       "Fam2_HPAH     0.000000  1.000000  \n",
       "Fam3_Ctrl     0.000000  2.236068  \n",
       "\n",
       "[11 rows x 34706 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "iPSC_data_sq = scprep.transform.sqrt(iPSC_data)\n",
    "iPSC_data_sq"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "alien-chassis",
   "metadata": {},
   "source": [
    "## Imputation and the Netflix Problem (Denoising data using MAGIC):\n",
    "- Imputation covers a set of approaches for taking missing values in a matrix (e.g. a counts matrix of genes by cells) and filling them in."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "trying-vertical",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.decomposition import PCA\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "pc_op = PCA()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "confirmed-allah",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: magic-impute in /root/.local/lib/python3.8/site-packages (3.0.0)\n",
      "Requirement already satisfied: graphtools>=1.4.0 in /root/.local/lib/python3.8/site-packages (from magic-impute) (1.5.2)\n",
      "Requirement already satisfied: scprep>=1.0 in /root/.local/lib/python3.8/site-packages (from magic-impute) (1.1.0)\n",
      "Requirement already satisfied: numpy>=1.14.0 in /opt/python/lib/python3.8/site-packages (from magic-impute) (1.19.5)\n",
      "Requirement already satisfied: pandas>=0.25 in /opt/python/lib/python3.8/site-packages (from magic-impute) (1.2.0)\n",
      "Requirement already satisfied: matplotlib in /opt/python/lib/python3.8/site-packages (from magic-impute) (3.3.3)\n",
      "Requirement already satisfied: scipy>=1.1.0 in /opt/python/lib/python3.8/site-packages (from magic-impute) (1.6.0)\n",
      "Requirement already satisfied: scikit-learn>=0.19.1 in /opt/python/lib/python3.8/site-packages (from magic-impute) (0.24.0)\n",
      "Requirement already satisfied: tasklogger>=1.0.0 in /root/.local/lib/python3.8/site-packages (from magic-impute) (1.0.0)\n",
      "Requirement already satisfied: future in /opt/python/lib/python3.8/site-packages (from magic-impute) (0.18.2)\n",
      "Requirement already satisfied: pygsp>=0.5.1 in /root/.local/lib/python3.8/site-packages (from graphtools>=1.4.0->magic-impute) (0.5.1)\n",
      "Requirement already satisfied: Deprecated in /root/.local/lib/python3.8/site-packages (from graphtools>=1.4.0->magic-impute) (1.2.12)\n",
      "Requirement already satisfied: python-dateutil>=2.7.3 in /opt/python/lib/python3.8/site-packages (from pandas>=0.25->magic-impute) (2.8.1)\n",
      "Requirement already satisfied: pytz>=2017.3 in /opt/python/lib/python3.8/site-packages (from pandas>=0.25->magic-impute) (2020.5)\n",
      "Requirement already satisfied: six>=1.5 in /opt/python/lib/python3.8/site-packages (from python-dateutil>=2.7.3->pandas>=0.25->magic-impute) (1.15.0)\n",
      "Requirement already satisfied: joblib>=0.11 in /opt/python/lib/python3.8/site-packages (from scikit-learn>=0.19.1->magic-impute) (1.0.0)\n",
      "Requirement already satisfied: threadpoolctl>=2.0.0 in /opt/python/lib/python3.8/site-packages (from scikit-learn>=0.19.1->magic-impute) (2.1.0)\n",
      "Requirement already satisfied: decorator>=4.3.0 in /opt/python/lib/python3.8/site-packages (from scprep>=1.0->magic-impute) (4.4.2)\n",
      "Requirement already satisfied: packaging in /opt/python/lib/python3.8/site-packages (from scprep>=1.0->magic-impute) (20.8)\n",
      "Requirement already satisfied: wrapt<2,>=1.10 in /opt/python/lib/python3.8/site-packages (from Deprecated->graphtools>=1.4.0->magic-impute) (1.12.1)\n",
      "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3 in /opt/python/lib/python3.8/site-packages (from matplotlib->magic-impute) (2.4.7)\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /opt/python/lib/python3.8/site-packages (from matplotlib->magic-impute) (1.3.1)\n",
      "Requirement already satisfied: cycler>=0.10 in /opt/python/lib/python3.8/site-packages (from matplotlib->magic-impute) (0.10.0)\n",
      "Requirement already satisfied: pillow>=6.2.0 in /opt/python/lib/python3.8/site-packages (from matplotlib->magic-impute) (8.1.0)\n",
      "\u001b[33mWARNING: You are using pip version 20.3.3; however, version 21.0.1 is available.\n",
      "You should consider upgrading via the '/opt/python/bin/python3.8 -m pip install --upgrade pip' command.\u001b[0m\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install --user magic-impute"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "artistic-mystery",
   "metadata": {},
   "outputs": [],
   "source": [
    "import magic"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "becoming-british",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.decomposition import PCA\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "pc_op = PCA()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "pointed-brunswick",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Calculating MAGIC...\n",
      "  Running MAGIC on 11 cells and 34706 genes.\n",
      "  Calculating graph and diffusion operator...\n",
      "    Calculating PCA...\n",
      "    Calculated PCA in 0.11 seconds.\n",
      "    Calculating KNN search...\n",
      "    Calculating affinities...\n",
      "  Calculated graph and diffusion operator in 2.50 seconds.\n",
      "  Calculating imputation...\n",
      "Calculated MAGIC in 4.87 seconds.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>5S_rRNA</th>\n",
       "      <th>7SK</th>\n",
       "      <th>A1BG</th>\n",
       "      <th>A1BG-AS1</th>\n",
       "      <th>A1CF</th>\n",
       "      <th>A2M</th>\n",
       "      <th>A2M-AS1</th>\n",
       "      <th>A2ML1</th>\n",
       "      <th>A2MP1</th>\n",
       "      <th>A3GALT2</th>\n",
       "      <th>...</th>\n",
       "      <th>hsa-mir-8072</th>\n",
       "      <th>snR65</th>\n",
       "      <th>snoR442</th>\n",
       "      <th>snoU109</th>\n",
       "      <th>snoU13</th>\n",
       "      <th>snoU2-30</th>\n",
       "      <th>snoU2_19</th>\n",
       "      <th>snoZ13_snr52</th>\n",
       "      <th>snoZ185</th>\n",
       "      <th>snoZ5</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P1</th>\n",
       "      <td>1.441336</td>\n",
       "      <td>10.213705</td>\n",
       "      <td>1.948149</td>\n",
       "      <td>7.248074</td>\n",
       "      <td>0.097478</td>\n",
       "      <td>63.735523</td>\n",
       "      <td>2.732261</td>\n",
       "      <td>0.608818</td>\n",
       "      <td>0.734730</td>\n",
       "      <td>0.174956</td>\n",
       "      <td>...</td>\n",
       "      <td>3.002683</td>\n",
       "      <td>0.194314</td>\n",
       "      <td>0.518407</td>\n",
       "      <td>3.752760</td>\n",
       "      <td>10.141872</td>\n",
       "      <td>5.731330</td>\n",
       "      <td>7.050887</td>\n",
       "      <td>0.091127</td>\n",
       "      <td>0.119086</td>\n",
       "      <td>0.748487</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_HPAH</th>\n",
       "      <td>1.426961</td>\n",
       "      <td>10.140777</td>\n",
       "      <td>1.975307</td>\n",
       "      <td>7.274259</td>\n",
       "      <td>0.092930</td>\n",
       "      <td>62.168377</td>\n",
       "      <td>2.669258</td>\n",
       "      <td>0.602888</td>\n",
       "      <td>0.718088</td>\n",
       "      <td>0.175439</td>\n",
       "      <td>...</td>\n",
       "      <td>2.975615</td>\n",
       "      <td>0.182594</td>\n",
       "      <td>0.514482</td>\n",
       "      <td>3.756853</td>\n",
       "      <td>10.078985</td>\n",
       "      <td>5.696532</td>\n",
       "      <td>7.005110</td>\n",
       "      <td>0.102361</td>\n",
       "      <td>0.127845</td>\n",
       "      <td>0.732369</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_Carrier</th>\n",
       "      <td>1.427934</td>\n",
       "      <td>10.151830</td>\n",
       "      <td>1.972647</td>\n",
       "      <td>7.273839</td>\n",
       "      <td>0.093684</td>\n",
       "      <td>62.464604</td>\n",
       "      <td>2.680750</td>\n",
       "      <td>0.604348</td>\n",
       "      <td>0.721765</td>\n",
       "      <td>0.174946</td>\n",
       "      <td>...</td>\n",
       "      <td>2.978958</td>\n",
       "      <td>0.184801</td>\n",
       "      <td>0.514985</td>\n",
       "      <td>3.758210</td>\n",
       "      <td>10.087812</td>\n",
       "      <td>5.703153</td>\n",
       "      <td>7.015063</td>\n",
       "      <td>0.100272</td>\n",
       "      <td>0.127242</td>\n",
       "      <td>0.733998</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_Carrier</th>\n",
       "      <td>1.459253</td>\n",
       "      <td>10.247724</td>\n",
       "      <td>1.922563</td>\n",
       "      <td>7.207659</td>\n",
       "      <td>0.099139</td>\n",
       "      <td>63.788277</td>\n",
       "      <td>2.753466</td>\n",
       "      <td>0.610209</td>\n",
       "      <td>0.735465</td>\n",
       "      <td>0.177265</td>\n",
       "      <td>...</td>\n",
       "      <td>3.027093</td>\n",
       "      <td>0.196192</td>\n",
       "      <td>0.520971</td>\n",
       "      <td>3.733553</td>\n",
       "      <td>10.186642</td>\n",
       "      <td>5.743358</td>\n",
       "      <td>7.055207</td>\n",
       "      <td>0.088602</td>\n",
       "      <td>0.108239</td>\n",
       "      <td>0.763372</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_Carrier</th>\n",
       "      <td>1.432446</td>\n",
       "      <td>10.226404</td>\n",
       "      <td>1.946534</td>\n",
       "      <td>7.244600</td>\n",
       "      <td>0.098838</td>\n",
       "      <td>64.666278</td>\n",
       "      <td>2.723666</td>\n",
       "      <td>0.603669</td>\n",
       "      <td>0.725428</td>\n",
       "      <td>0.172590</td>\n",
       "      <td>...</td>\n",
       "      <td>2.984538</td>\n",
       "      <td>0.194734</td>\n",
       "      <td>0.516876</td>\n",
       "      <td>3.758772</td>\n",
       "      <td>10.110059</td>\n",
       "      <td>5.728138</td>\n",
       "      <td>7.054362</td>\n",
       "      <td>0.092073</td>\n",
       "      <td>0.120037</td>\n",
       "      <td>0.754149</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P3</th>\n",
       "      <td>1.421195</td>\n",
       "      <td>10.145971</td>\n",
       "      <td>1.983691</td>\n",
       "      <td>7.293137</td>\n",
       "      <td>0.093190</td>\n",
       "      <td>62.615466</td>\n",
       "      <td>2.677172</td>\n",
       "      <td>0.606376</td>\n",
       "      <td>0.718494</td>\n",
       "      <td>0.173945</td>\n",
       "      <td>...</td>\n",
       "      <td>2.973323</td>\n",
       "      <td>0.184686</td>\n",
       "      <td>0.517280</td>\n",
       "      <td>3.766603</td>\n",
       "      <td>10.082264</td>\n",
       "      <td>5.706052</td>\n",
       "      <td>7.025241</td>\n",
       "      <td>0.098835</td>\n",
       "      <td>0.133012</td>\n",
       "      <td>0.727632</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_HPAH_P2</th>\n",
       "      <td>1.426294</td>\n",
       "      <td>10.162839</td>\n",
       "      <td>1.976261</td>\n",
       "      <td>7.287591</td>\n",
       "      <td>0.094448</td>\n",
       "      <td>62.750844</td>\n",
       "      <td>2.694378</td>\n",
       "      <td>0.609060</td>\n",
       "      <td>0.718391</td>\n",
       "      <td>0.174208</td>\n",
       "      <td>...</td>\n",
       "      <td>2.981081</td>\n",
       "      <td>0.186407</td>\n",
       "      <td>0.519768</td>\n",
       "      <td>3.762325</td>\n",
       "      <td>10.104835</td>\n",
       "      <td>5.720748</td>\n",
       "      <td>7.043749</td>\n",
       "      <td>0.095956</td>\n",
       "      <td>0.129251</td>\n",
       "      <td>0.732161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam1_Ctrl</th>\n",
       "      <td>1.444965</td>\n",
       "      <td>10.118318</td>\n",
       "      <td>1.975342</td>\n",
       "      <td>7.279864</td>\n",
       "      <td>0.089895</td>\n",
       "      <td>60.435545</td>\n",
       "      <td>2.679661</td>\n",
       "      <td>0.610905</td>\n",
       "      <td>0.725998</td>\n",
       "      <td>0.181889</td>\n",
       "      <td>...</td>\n",
       "      <td>3.005874</td>\n",
       "      <td>0.180023</td>\n",
       "      <td>0.520508</td>\n",
       "      <td>3.741371</td>\n",
       "      <td>10.136513</td>\n",
       "      <td>5.707243</td>\n",
       "      <td>7.005799</td>\n",
       "      <td>0.100544</td>\n",
       "      <td>0.126183</td>\n",
       "      <td>0.720497</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_Ctrl</th>\n",
       "      <td>1.429413</td>\n",
       "      <td>10.224887</td>\n",
       "      <td>1.950620</td>\n",
       "      <td>7.249589</td>\n",
       "      <td>0.099563</td>\n",
       "      <td>64.773613</td>\n",
       "      <td>2.717853</td>\n",
       "      <td>0.604375</td>\n",
       "      <td>0.725664</td>\n",
       "      <td>0.171144</td>\n",
       "      <td>...</td>\n",
       "      <td>2.983537</td>\n",
       "      <td>0.193470</td>\n",
       "      <td>0.514598</td>\n",
       "      <td>3.766877</td>\n",
       "      <td>10.108955</td>\n",
       "      <td>5.721627</td>\n",
       "      <td>7.045493</td>\n",
       "      <td>0.092481</td>\n",
       "      <td>0.120577</td>\n",
       "      <td>0.757153</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam2_HPAH</th>\n",
       "      <td>1.428343</td>\n",
       "      <td>10.242926</td>\n",
       "      <td>1.944343</td>\n",
       "      <td>7.237563</td>\n",
       "      <td>0.100541</td>\n",
       "      <td>65.363095</td>\n",
       "      <td>2.727701</td>\n",
       "      <td>0.602548</td>\n",
       "      <td>0.724388</td>\n",
       "      <td>0.169834</td>\n",
       "      <td>...</td>\n",
       "      <td>2.980166</td>\n",
       "      <td>0.197134</td>\n",
       "      <td>0.515663</td>\n",
       "      <td>3.762587</td>\n",
       "      <td>10.102542</td>\n",
       "      <td>5.727754</td>\n",
       "      <td>7.057562</td>\n",
       "      <td>0.091191</td>\n",
       "      <td>0.119295</td>\n",
       "      <td>0.761099</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fam3_Ctrl</th>\n",
       "      <td>1.431581</td>\n",
       "      <td>10.230979</td>\n",
       "      <td>1.946892</td>\n",
       "      <td>7.243761</td>\n",
       "      <td>0.099889</td>\n",
       "      <td>64.835803</td>\n",
       "      <td>2.724365</td>\n",
       "      <td>0.604316</td>\n",
       "      <td>0.727206</td>\n",
       "      <td>0.171325</td>\n",
       "      <td>...</td>\n",
       "      <td>2.985965</td>\n",
       "      <td>0.194865</td>\n",
       "      <td>0.515062</td>\n",
       "      <td>3.763425</td>\n",
       "      <td>10.113752</td>\n",
       "      <td>5.724782</td>\n",
       "      <td>7.049150</td>\n",
       "      <td>0.091782</td>\n",
       "      <td>0.118950</td>\n",
       "      <td>0.758605</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11 rows × 34706 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               5S_rRNA        7SK      A1BG  A1BG-AS1      A1CF        A2M  \\\n",
       "Fam1_HPAH_P1  1.441336  10.213705  1.948149  7.248074  0.097478  63.735523   \n",
       "Fam3_HPAH     1.426961  10.140777  1.975307  7.274259  0.092930  62.168377   \n",
       "Fam3_Carrier  1.427934  10.151830  1.972647  7.273839  0.093684  62.464604   \n",
       "Fam1_Carrier  1.459253  10.247724  1.922563  7.207659  0.099139  63.788277   \n",
       "Fam2_Carrier  1.432446  10.226404  1.946534  7.244600  0.098838  64.666278   \n",
       "Fam1_HPAH_P3  1.421195  10.145971  1.983691  7.293137  0.093190  62.615466   \n",
       "Fam1_HPAH_P2  1.426294  10.162839  1.976261  7.287591  0.094448  62.750844   \n",
       "Fam1_Ctrl     1.444965  10.118318  1.975342  7.279864  0.089895  60.435545   \n",
       "Fam2_Ctrl     1.429413  10.224887  1.950620  7.249589  0.099563  64.773613   \n",
       "Fam2_HPAH     1.428343  10.242926  1.944343  7.237563  0.100541  65.363095   \n",
       "Fam3_Ctrl     1.431581  10.230979  1.946892  7.243761  0.099889  64.835803   \n",
       "\n",
       "               A2M-AS1     A2ML1     A2MP1   A3GALT2  ...  hsa-mir-8072  \\\n",
       "Fam1_HPAH_P1  2.732261  0.608818  0.734730  0.174956  ...      3.002683   \n",
       "Fam3_HPAH     2.669258  0.602888  0.718088  0.175439  ...      2.975615   \n",
       "Fam3_Carrier  2.680750  0.604348  0.721765  0.174946  ...      2.978958   \n",
       "Fam1_Carrier  2.753466  0.610209  0.735465  0.177265  ...      3.027093   \n",
       "Fam2_Carrier  2.723666  0.603669  0.725428  0.172590  ...      2.984538   \n",
       "Fam1_HPAH_P3  2.677172  0.606376  0.718494  0.173945  ...      2.973323   \n",
       "Fam1_HPAH_P2  2.694378  0.609060  0.718391  0.174208  ...      2.981081   \n",
       "Fam1_Ctrl     2.679661  0.610905  0.725998  0.181889  ...      3.005874   \n",
       "Fam2_Ctrl     2.717853  0.604375  0.725664  0.171144  ...      2.983537   \n",
       "Fam2_HPAH     2.727701  0.602548  0.724388  0.169834  ...      2.980166   \n",
       "Fam3_Ctrl     2.724365  0.604316  0.727206  0.171325  ...      2.985965   \n",
       "\n",
       "                 snR65   snoR442   snoU109     snoU13  snoU2-30  snoU2_19  \\\n",
       "Fam1_HPAH_P1  0.194314  0.518407  3.752760  10.141872  5.731330  7.050887   \n",
       "Fam3_HPAH     0.182594  0.514482  3.756853  10.078985  5.696532  7.005110   \n",
       "Fam3_Carrier  0.184801  0.514985  3.758210  10.087812  5.703153  7.015063   \n",
       "Fam1_Carrier  0.196192  0.520971  3.733553  10.186642  5.743358  7.055207   \n",
       "Fam2_Carrier  0.194734  0.516876  3.758772  10.110059  5.728138  7.054362   \n",
       "Fam1_HPAH_P3  0.184686  0.517280  3.766603  10.082264  5.706052  7.025241   \n",
       "Fam1_HPAH_P2  0.186407  0.519768  3.762325  10.104835  5.720748  7.043749   \n",
       "Fam1_Ctrl     0.180023  0.520508  3.741371  10.136513  5.707243  7.005799   \n",
       "Fam2_Ctrl     0.193470  0.514598  3.766877  10.108955  5.721627  7.045493   \n",
       "Fam2_HPAH     0.197134  0.515663  3.762587  10.102542  5.727754  7.057562   \n",
       "Fam3_Ctrl     0.194865  0.515062  3.763425  10.113752  5.724782  7.049150   \n",
       "\n",
       "              snoZ13_snr52   snoZ185     snoZ5  \n",
       "Fam1_HPAH_P1      0.091127  0.119086  0.748487  \n",
       "Fam3_HPAH         0.102361  0.127845  0.732369  \n",
       "Fam3_Carrier      0.100272  0.127242  0.733998  \n",
       "Fam1_Carrier      0.088602  0.108239  0.763372  \n",
       "Fam2_Carrier      0.092073  0.120037  0.754149  \n",
       "Fam1_HPAH_P3      0.098835  0.133012  0.727632  \n",
       "Fam1_HPAH_P2      0.095956  0.129251  0.732161  \n",
       "Fam1_Ctrl         0.100544  0.126183  0.720497  \n",
       "Fam2_Ctrl         0.092481  0.120577  0.757153  \n",
       "Fam2_HPAH         0.091191  0.119295  0.761099  \n",
       "Fam3_Ctrl         0.091782  0.118950  0.758605  \n",
       "\n",
       "[11 rows x 34706 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "magic_operator = magic.MAGIC(knn=5, knn_max= 9, solver='approximate', n_pca = 9)\n",
    "iPSC_data_magic = magic_operator.fit_transform(iPSC_data_sq)\n",
    "iPSC_data_magic\n",
    "\n",
    "#magic_operator = magic.MAGIC()\n",
    "#iPSC_data_magic = magic_operator.fit_transform(iPSC_data_sq)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "typical-investment",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.decomposition import PCA\n",
    "from sklearn.preprocessing import StandardScaler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "express-resort",
   "metadata": {},
   "outputs": [],
   "source": [
    "pc_op = PCA()\n",
    "scaler = StandardScaler() \n",
    "iPSC_scaled =scaler.fit_transform(iPSC_data_magic)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "union-range",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Fam1_HPAH_P1</th>\n",
       "      <th>Fam3_HPAH</th>\n",
       "      <th>Fam3_Carrier</th>\n",
       "      <th>Fam1_Carrier</th>\n",
       "      <th>Fam2_Carrier</th>\n",
       "      <th>Fam1_HPAH_P3</th>\n",
       "      <th>Fam1_HPAH_P2</th>\n",
       "      <th>Fam1_Ctrl</th>\n",
       "      <th>Fam2_Ctrl</th>\n",
       "      <th>Fam2_HPAH</th>\n",
       "      <th>Fam3_Ctrl</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5S_rRNA</th>\n",
       "      <td>0.602060</td>\n",
       "      <td>0.301030</td>\n",
       "      <td>0.477121</td>\n",
       "      <td>0.778151</td>\n",
       "      <td>0.845098</td>\n",
       "      <td>0.301030</td>\n",
       "      <td>0.301030</td>\n",
       "      <td>0.778151</td>\n",
       "      <td>0.301030</td>\n",
       "      <td>0.301030</td>\n",
       "      <td>0.301030</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7SK</th>\n",
       "      <td>2.064458</td>\n",
       "      <td>1.869232</td>\n",
       "      <td>1.919078</td>\n",
       "      <td>2.100371</td>\n",
       "      <td>2.079181</td>\n",
       "      <td>1.857332</td>\n",
       "      <td>2.004321</td>\n",
       "      <td>1.875061</td>\n",
       "      <td>2.178977</td>\n",
       "      <td>2.164353</td>\n",
       "      <td>2.012837</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A1BG</th>\n",
       "      <td>0.602060</td>\n",
       "      <td>0.602060</td>\n",
       "      <td>0.778151</td>\n",
       "      <td>0.301030</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.079181</td>\n",
       "      <td>0.903090</td>\n",
       "      <td>0.845098</td>\n",
       "      <td>0.698970</td>\n",
       "      <td>0.778151</td>\n",
       "      <td>0.778151</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A1BG-AS1</th>\n",
       "      <td>1.778151</td>\n",
       "      <td>1.748188</td>\n",
       "      <td>1.491362</td>\n",
       "      <td>1.397940</td>\n",
       "      <td>1.748188</td>\n",
       "      <td>1.819544</td>\n",
       "      <td>2.017033</td>\n",
       "      <td>1.770852</td>\n",
       "      <td>1.851258</td>\n",
       "      <td>1.204120</td>\n",
       "      <td>1.869232</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A1CF</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.301030</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>snoU2-30</th>\n",
       "      <td>1.579784</td>\n",
       "      <td>1.301030</td>\n",
       "      <td>1.447158</td>\n",
       "      <td>1.732394</td>\n",
       "      <td>1.806180</td>\n",
       "      <td>1.462398</td>\n",
       "      <td>1.857332</td>\n",
       "      <td>1.301030</td>\n",
       "      <td>1.414973</td>\n",
       "      <td>1.301030</td>\n",
       "      <td>1.397940</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>snoU2_19</th>\n",
       "      <td>1.724276</td>\n",
       "      <td>1.414973</td>\n",
       "      <td>1.556303</td>\n",
       "      <td>1.851258</td>\n",
       "      <td>2.021189</td>\n",
       "      <td>1.698970</td>\n",
       "      <td>2.075547</td>\n",
       "      <td>1.397940</td>\n",
       "      <td>1.505150</td>\n",
       "      <td>1.518514</td>\n",
       "      <td>1.690196</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>snoZ13_snr52</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.301030</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>snoZ185</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.477121</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>snoZ5</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.698970</td>\n",
       "      <td>0.477121</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.477121</td>\n",
       "      <td>0.301030</td>\n",
       "      <td>0.778151</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>34706 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              Fam1_HPAH_P1  Fam3_HPAH  Fam3_Carrier  Fam1_Carrier  \\\n",
       "id                                                                  \n",
       "5S_rRNA           0.602060   0.301030      0.477121      0.778151   \n",
       "7SK               2.064458   1.869232      1.919078      2.100371   \n",
       "A1BG              0.602060   0.602060      0.778151      0.301030   \n",
       "A1BG-AS1          1.778151   1.748188      1.491362      1.397940   \n",
       "A1CF              0.000000   0.000000      0.000000      0.000000   \n",
       "...                    ...        ...           ...           ...   \n",
       "snoU2-30          1.579784   1.301030      1.447158      1.732394   \n",
       "snoU2_19          1.724276   1.414973      1.556303      1.851258   \n",
       "snoZ13_snr52      0.000000   0.301030      0.000000      0.000000   \n",
       "snoZ185           0.000000   0.000000      0.000000      0.000000   \n",
       "snoZ5             0.000000   0.000000      0.698970      0.477121   \n",
       "\n",
       "              Fam2_Carrier  Fam1_HPAH_P3  Fam1_HPAH_P2  Fam1_Ctrl  Fam2_Ctrl  \\\n",
       "id                                                                             \n",
       "5S_rRNA           0.845098      0.301030      0.301030   0.778151   0.301030   \n",
       "7SK               2.079181      1.857332      2.004321   1.875061   2.178977   \n",
       "A1BG              0.000000      1.079181      0.903090   0.845098   0.698970   \n",
       "A1BG-AS1          1.748188      1.819544      2.017033   1.770852   1.851258   \n",
       "A1CF              0.000000      0.000000      0.000000   0.000000   0.000000   \n",
       "...                    ...           ...           ...        ...        ...   \n",
       "snoU2-30          1.806180      1.462398      1.857332   1.301030   1.414973   \n",
       "snoU2_19          2.021189      1.698970      2.075547   1.397940   1.505150   \n",
       "snoZ13_snr52      0.000000      0.000000      0.000000   0.000000   0.000000   \n",
       "snoZ185           0.000000      0.477121      0.000000   0.000000   0.000000   \n",
       "snoZ5             0.000000      0.000000      0.000000   0.000000   0.477121   \n",
       "\n",
       "              Fam2_HPAH  Fam3_Ctrl  \n",
       "id                                  \n",
       "5S_rRNA        0.301030   0.301030  \n",
       "7SK            2.164353   2.012837  \n",
       "A1BG           0.778151   0.778151  \n",
       "A1BG-AS1       1.204120   1.869232  \n",
       "A1CF           0.000000   0.301030  \n",
       "...                 ...        ...  \n",
       "snoU2-30       1.301030   1.397940  \n",
       "snoU2_19       1.518514   1.690196  \n",
       "snoZ13_snr52   0.000000   0.000000  \n",
       "snoZ185        0.000000   0.000000  \n",
       "snoZ5          0.301030   0.778151  \n",
       "\n",
       "[34706 rows x 11 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "iPSC_scaled_T = scaler.fit_transform(iPSC_data_magic).T\n",
    "iPSC_data_T_log"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "herbal-frederick",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "genes_per_cell = np.sum(iPSC_scaled_T > 0, axis=0)\n",
    "\n",
    "fig, ax = plt.subplots(1, figsize=(8,8))\n",
    "ax.hist(iPSC_scaled_T, bins=50)\n",
    "ax.set_xlabel('Genes')\n",
    "ax.set_ylabel('Frequency')\n",
    "ax.set_yscale('symlog')\n",
    "ax.set_title('Gene detection across Samples')\n",
    "fig.tight_layout()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "photographic-pasta",
   "metadata": {},
   "source": [
    "### Visualization (Principle Component Analysis): \n",
    "#### Heatmaps (seaborn):\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "ecological-romantic",
   "metadata": {},
   "outputs": [],
   "source": [
    "import seaborn as sns "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "clean-prisoner",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.decomposition import PCA\n",
    "from sklearn.preprocessing import StandardScaler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "ceramic-recording",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: fastcluster in /opt/python/lib/python3.8/site-packages (1.1.28)\n",
      "Requirement already satisfied: numpy>=1.9 in /opt/python/lib/python3.8/site-packages (from fastcluster) (1.19.5)\n",
      "\u001b[33mWARNING: You are using pip version 20.3.3; however, version 21.0.1 is available.\n",
      "You should consider upgrading via the '/opt/python/bin/python3.8 -m pip install --upgrade pip' command.\u001b[0m\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install fastcluster"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "narrative-individual",
   "metadata": {},
   "outputs": [],
   "source": [
    "scaler = StandardScaler() "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "three-prospect",
   "metadata": {},
   "outputs": [],
   "source": [
    "scaled =scaler.fit_transform(iPSC_data_magic)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "serial-output",
   "metadata": {},
   "source": [
    "# Error: Not working "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "reduced-airplane",
   "metadata": {},
   "outputs": [],
   "source": [
    "#cg = sns.clustermap(scaled, cmap='inferno', xticklabels=[], yticklabels=[], standard_scale = 1)\n",
    "#cg.ax_heatmap.set_xlabel('Genes ({})'.format(scaled.shape[1]))\n",
    "#cg.ax_heatmap.set_ylabel('Samples ({})'.format(scaled.shape[0]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "improved-conducting",
   "metadata": {},
   "source": [
    "### Reduction (PCA)\n",
    "- Doing multiplication or inversion of matrices with 1,000+ dimensions gets very slow and takes up a lot of memory so we typically only store 100-500 PCs and use this for downstream analysis. \n",
    "- PCA gives us a quantification of how much variance we’ve lost by removing some of the final principal components. This means we can figure out how many we need to capture 99.999% of the variance in a dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "psychological-fraction",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, ax = plt.subplots(1, figsize=(5,5))\n",
    "\n",
    "ax.scatter(scaled[:,0], scaled[:,1], s=20)\n",
    "ax.set_xlabel('PC1')\n",
    "ax.set_ylabel('PC2')\n",
    "ax.set_title('T-cell - PCA')\n",
    "\n",
    "fig.tight_layout()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "patent-worse",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x7fddef596820>"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "X = pc_op.fit_transform(iPSC_data_magic.values.T)\n",
    "X.shape \n",
    "plt.scatter(X[:,0], X[:,1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "coordinate-threat",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
